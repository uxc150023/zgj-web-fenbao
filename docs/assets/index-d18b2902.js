import{J as e,V as t,K as a,M as o,N as r,O as i,P as s}from"./chunk-vform-c3afb8ec.js";import{a as l}from"./index-d67b578f.js";import{E as n}from"./chunk-element-plus-b8773542.js";import{aA as u,k as d,al as m,as as p,o as c,m as g,a$ as f,ab as v}from"./chunk-vue-0eb5cee7.js";import"./chunk-ant-design-vue-bd7f8294.js";import"./chunk-@ant-design-icons-svg-8f5189a2.js";import"./chunk-@ant-design-icons-vue-ff9a333c.js";const F={languageMenu:!1,externalLink:!1,formTemplates:!0,widgetNameReadonly:!1,eventCollapse:!0,clearDesignerButton:!1,previewFormButton:!0,importJsonButton:!0,exportJsonButton:!0,exportCodeButton:!1,generateSFCButton:!0,toolbarMaxWidth:420,toolbarMinWidth:300,presetCssCode:"",resetFormJson:!1,productName:"",productTitle:"",logoHeader:!1},y={name:"JyVform"},h=Object.assign(y,{props:{mode:{type:String,default:""},designerConfig:{type:Object,default:()=>F},formJson:{type:Object,default:()=>{}},formData:{type:Object,default:()=>{}},optionData:{type:Object,default:()=>{}},hideModuleList:{type:Array,default:()=>[]},prefabricationFieldList:{type:Array,default:()=>[]},userType:{type:String,default:""}},emits:["formChange","appendButtonClick","buttonClick","on-loaded"],setup(y,{expose:h,emit:b}){const L=y,D=e(),J=u(null),j=u([]),k=u([]),C=u(0),T=d((()=>D.fileTypeList||[])),B=e=>{b("buttonClick",e)},W=e=>{b("appendButtonClick",e)},w=(e,t,a,o,r,i)=>{b("formChange",{fieldName:e,newValue:t,oldValue:a,formModel:o,subFormName:r,subFormRowIndex:i})},M=async e=>{try{const t=await l.formColumnBasic({applyTypeId:e}),a=[...o,...r,...i,...s].map((e=>e.type)).filter((e=>![...t.data.columSys,...t.data.columBiz].includes(e)));j.value=a,C.value++}catch(t){n.error(t)}},O=async e=>{try{const t=await l.getFormTemplate({applyTypeId:e});k.value=t.data.map((e=>JSON.parse(e.formTemplateInfo)));const a=J.value.getFieldWidgets();v((()=>{L.mode||a.length||J.value.setFormJson(JSON.parse(JSON.stringify(k.value[0].jsonUrl)))}))}catch(t){n.error(t)}};return m((()=>{b("on-loaded")})),h({getFormJson:()=>J.value.getFormJson()||"",clearDesigner:()=>{J.value.clearDesigner()},previewForm:()=>{J.value.previewForm()},getFieldWidgets:()=>J.value.getFieldWidgets(),exportJson:()=>{J.value.exportJson()},importJson:e=>{J.value.importJson(e)},getWidgetRef:e=>J.value.getWidgetRef(e),buildFormDataSchema:()=>J.value.buildFormDataSchema(),changeLanguage:()=>{J.value.changeLanguage()},setFormJson:e=>{J.value.setFormJson(e)},validateForm:async()=>{let e=!1;return await J.value.validateForm((t=>{e=t})),e},getFormData:async(e=!0)=>{try{return J.value.getFormData(e)}catch(t){return Promise.reject(t)}},setFormData:e=>{J.value.setFormData(e)},setFieldValue:(e,t)=>{J.value.setFieldValue(e,t)},resetForm:()=>{J.value.resetForm()},setReadMode:()=>{J.value.setReadMode()},showDialog:()=>{J.value.showDialog()},setFormColumnBasic:M,setFormTemplate:O,initDesigner:e=>{M(e),O(e)},disableForm:()=>{J.value.disableForm()},getFieldValue:async e=>{try{return J.value.getFieldValue(e)}catch(t){return Promise.reject(t)}},reloadOptionData:async e=>{try{return J.value.reloadOptionData(e)}catch(t){return Promise.reject(t)}},hideWidgets:(e=null)=>{J.value.hideWidgets(e)},disableWidgets:(e=null)=>{J.value.disableWidgets(e)}}),(e,o)=>(p(),c("div",null,["render"===L.mode?(p(),g(f(t),{key:0,"form-json":L.formJson,"form-data":L.formData,optionData:L.optionData,ref_key:"vFormRef",ref:J,onFormChange:w,onAppendButtonClick:W,onButtonClick:B,fileTypeList:f(T),prefabricationFieldList:L.prefabricationFieldList},null,8,["form-json","form-data","optionData","fileTypeList","prefabricationFieldList"])):(p(),g(f(a),{ref_key:"vFormRef",ref:J,bannedWidgets:j.value,"designer-config":f(F),hideModuleList:y.hideModuleList,prefabricationFieldList:L.prefabricationFieldList,templateList:k.value,fileTypeList:f(T),userType:y.userType,key:C.value},null,8,["bannedWidgets","designer-config","hideModuleList","prefabricationFieldList","templateList","fileTypeList","userType"]))]))}});export{h as default};
