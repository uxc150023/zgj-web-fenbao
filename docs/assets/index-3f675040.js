import e from"./index-6d3dcf63.js";import{B as a,g as l,Q as t,R as r,o}from"./chunk-vform-2b3347cb.js";import n from"./index-f895f36f.js";import{y as s,a as i}from"./yuan-hui-31c99901.js";import{aA as u,k as d,ag as p,as as m,o as c,x as N,p as y,F as E,aD as b,ae as v,aT as T,n as A,w as S,a$ as f,m as M,aa as h,ab as g,aF as O,bj as I,ay as _,be as L,aH as R,a4 as j}from"./chunk-vue-0eb5cee7.js";import{_ as k}from"./index-11f52a3c.js";const D={SYSTEM_FLOW_MANAGEMENT:"system_flow_management",SYSTEM_FORM_MANAGEMENT:"system_form_management",RULEBUSINESSMANAGEMENT:"rule_business_management",DEALINGUNIT:"dealing_unit",UNITANDDEPARTMENT:"unit_and_department"},U={TABS:[],URLS:[],INFO:[],TABLEHEADERS:[]};U.URLS=[{value:"detail",urlName:"baseInfo"},{value:"version",urlName:"queryHisVersion"},{value:"record",urlName:"viewOperation"}],U.TABS=[{name:"t-zgj-detail-flow.Detail",value:"detail",children:["BaseInfo","FlowDetail"]},{name:"t-zgj-detail-operation.Record",value:"record",children:["RecordTable"]},{name:"t-zgj-detail-flow.Version",value:"version",children:["VersionTable"]}],U.INFO=[{label:"流程名称",key:"flowName"},{label:"流程编码",key:"flowNo"},{label:"业务类型",key:"applyTypeName"},{label:"文件类型",key:["fileTypeScope"],handleKey:"fileScope"},{label:"流程状态",key:"flag",type:"status",customStyle:!0},{label:"流程适用范围",key:["organScope","organUserScope"],handleKey:"flowScope"},{label:"创建人",key:"createUserName"},{label:"创建时间",key:"createDatetime"},{label:"更新时间",key:"modifyDatetime"},{label:"流程说明",key:"readme"},{label:"关联表单",key:"formMessageName"}],U.TABLEHEADERS={version:[{label:"版本号",prop:"flowVerison"},{label:"版本时间",prop:"modifyDatetime"}],record:[{label:"操作人",prop:"operationUser"},{label:"操作时间",prop:"operationDate"},{label:"操作记录",prop:"operationType"},{label:"操作说明",prop:"operationTxt"}]};const w={TABS:[],URLS:[],INFO:[],TABLEHEADERS:[]};w.URLS=[{value:"detail",urlName:"baseInfo"},{value:"version",urlName:"queryHisVersion"},{value:"record",urlName:"viewOperation"}],w.TABS=[{name:"t-zgj-detail-flow.Detail",value:"detail",children:["BaseInfo"]},{name:"t-zgj-detail-operation.Record",value:"record",children:["RecordTable"]},{name:"t-zgj-detail-flow.Version",value:"version",children:["VersionTable"]}],w.INFO=[{label:"表单名称",key:"formName"},{label:"表单编码",key:"formNo"},{label:"业务类型",key:"applyTypeName"},{label:"用印类型",key:"sealUseTypeName"},{label:"表单状态",key:"flag",type:"status",customStyle:!0},{label:"创建时间",key:"createDatetimeStr"},{label:"创建人",key:"createUserName"},{label:"更新时间",key:"modifyDatetimeStr"},{label:"表单说明",key:"readme"}],w.TABLEHEADERS={version:[{label:"版本号",prop:"formVerison"},{label:"版本时间",prop:"modifyDatetime"}],record:[{label:"操作人",prop:"operationUser"},{label:"操作时间",prop:"operationDate"},{label:"操作记录",prop:"operationType"},{label:"操作说明",prop:"operationTxt"}]};const B={TABS:[],URLS:[],INFO:[],TABLEHEADERS:[]};B.URLS=[{value:"detail",urlName:"baseInfo"},{value:"record",urlName:"viewOperation"}],B.TABS=[{name:"t-zgj-detail-flow.Detail",value:"detail",children:["BaseInfo"]}],B.INFO=[{label:"业务规则名称",key:"ruleBusinessName"},{label:"业务规则编码",key:"ruleBusinessNo"},{label:"用印类型",key:"sealUseTypeName"},{label:"关联文件类型",key:["fileTypeList"],handleKey:"filteType"},{label:"业务规则状态",key:"flag",type:"status",customStyle:!0},{label:"创建人",key:"createUserName"},{label:"创建时间",key:"createDatetime"},{label:"更新时间",key:"modifyDatetime"}],B.TABLEHEADERS={record:[{label:"操作人",prop:"operationUser"},{label:"操作时间",prop:"operationDate"},{label:"操作记录",prop:"operationType"},{label:"操作说明",prop:"operationTxt"}]};const G={TABS:[],URLS:[],INFO:[],TABLEHEADERS:[]};G.URLS=[{value:"detail",urlName:"baseInfo"}],G.TABS=[{name:"t-zgj-detail-flow.Detail",value:"detail",children:["BaseInfo"]}],G.INFO=[{label:"企业名称",key:"relatedCompanyName"},{label:"企业编码",key:"relatedCompanyNo"},{label:"企业所属部门",key:"organName"},{label:"联系人",key:"contactName"},{label:"备注",key:"readme"}],G.TABLEHEADERS={};const F={TABS:[],URLS:[],INFO:[],TABLEHEADERS:[]};F.URLS=[{value:"detail",urlName:"baseInfo"},{value:"organizer",urlName:"uninUser"},{value:"record",urlName:"viewOperation"}],F.TABS=[{name:"t-zgj-detail-unit.UnitAndDepart",value:"detail",children:["BaseInfo"]},{name:"t-zgj-detail-unit.UnitUser",value:"organizer",children:["VersionTable"]}],F.INFO=[{label:"部门名称",key:"organName"},{label:"组织类型",key:"organTypeName"},{label:"部门主管",key:"organLeaderName"},{label:"部门编码",key:"organNo"},{label:"部门人数",key:"organUserNum"},{label:"上级部门",key:"organPName"},{label:"备注",key:"readme"}],F.TABLEHEADERS={organizer:[{label:"人员列表",prop:"userName"},{label:"账号",prop:"accountNo"}],record:[{label:"操作人",prop:"operator"},{label:"操作时间",prop:"operateDatetime"},{label:"操作记录",prop:"operateAction"},{label:"操作说明",prop:"operateDesc"}]};const q=[];q.push({[D.SYSTEM_FLOW_MANAGEMENT]:U,[D.SYSTEM_FORM_MANAGEMENT]:w,[D.RULEBUSINESSMANAGEMENT]:B,[D.DEALINGUNIT]:G,[D.UNITANDDEPARTMENT]:F});const H=(e,a)=>q[q.findIndex((a=>a[e]))][e].URLS[a].urlName,V=(e,a)=>q[q.findIndex((a=>a[e]))][e].URLS.findIndex((e=>e.value===a));let P={};P={[D.SYSTEM_FLOW_MANAGEMENT]:{[H(D.SYSTEM_FLOW_MANAGEMENT,V(D.SYSTEM_FLOW_MANAGEMENT,"detail"))]:e=>a({method:"GET",url:"/flow/query",params:e}),[H(D.SYSTEM_FLOW_MANAGEMENT,V(D.SYSTEM_FLOW_MANAGEMENT,"version"))]:e=>a({method:"GET",url:"/flow/queryHisVersion",params:e}),[H(D.SYSTEM_FLOW_MANAGEMENT,V(D.SYSTEM_FLOW_MANAGEMENT,"record"))]:e=>a({method:"GET",url:"/flow/viewOperation",params:e})},[D.SYSTEM_FORM_MANAGEMENT]:{[H(D.SYSTEM_FORM_MANAGEMENT,V(D.SYSTEM_FORM_MANAGEMENT,"detail"))]:e=>a({method:"GET",url:"/form/query",params:e}),[H(D.SYSTEM_FORM_MANAGEMENT,V(D.SYSTEM_FORM_MANAGEMENT,"version"))]:e=>a({method:"GET",url:"/form/queryHisVersion",params:e}),[H(D.SYSTEM_FORM_MANAGEMENT,V(D.SYSTEM_FORM_MANAGEMENT,"record"))]:e=>a({method:"GET",url:"/form/queryOperation",params:e})},[D.RULEBUSINESSMANAGEMENT]:{[H(D.RULEBUSINESSMANAGEMENT,V(D.RULEBUSINESSMANAGEMENT,"detail"))]:e=>a({method:"GET",url:`/biz/rule/view/${e}`})},[D.DEALINGUNIT]:{[H(D.DEALINGUNIT,V(D.DEALINGUNIT,"detail"))]:e=>a({method:"GET",url:`/tenant/relatedCompany/detail/${e}`})},[D.UNITANDDEPARTMENT]:{[H(D.UNITANDDEPARTMENT,V(D.UNITANDDEPARTMENT,"detail"))]:e=>a({method:"GET",url:`/organ/${e}`}),[H(D.UNITANDDEPARTMENT,V(D.UNITANDDEPARTMENT,"organizer"))]:e=>a({method:"GET",url:`/organ/userInfoList/${e}`})}};const x=P,Y={class:"flow-detail"},z={class:"info-list"},W={class:"cont"},C={class:"cont-details"},$={class:"cont-list-label"},K=["src"],Q={name:"BaseInfo"},J=l(Object.assign(Q,{props:{requestObj:{type:Object,defatult:()=>({})}},setup(e){const a=e,l=u({yuanLv:s,yuanHui:i,warning:"/zgj-web/assets/detail-warning-52514a54.svg",danger:"/zgj-web/assets/detail-danger-a1cea784.svg"}),t=["var(--jy-success-6)","var(--jy-color-text-4)","var(--jy-warning-6)","var(--jy-primary-6)","var(--jy-danger-6)"],r=d({get:()=>a.requestObj.info}),o=u({});p((()=>{x[a.requestObj.modulesName][a.requestObj.urlName](a.requestObj.params).then((e=>{e.data&&(r.value.forEach((a=>{for(const l in e.data)if(a.handleKey&&a.key.includes(l)&&Array.isArray(a.key))M(a.handleKey,e.data[l]);else if(l===a.key){if(a.customStyle){a.valStyle=g(a,e.data[l]),a.iconPath=O(a,e.data[l]),a.value=I(a,e.data[l]);continue}a.value=e.data[l]}})),r.value.forEach((e=>{e.handleKey&&(e.value=h(o.value[e.handleKey]))})))}))}));const M=(e,a)=>{a&&Array.isArray(a)&&(o.value.hasOwnProperty(e)?o.value[e]=o.value[e].concat(a):o.value[e]=a)},h=(e,a)=>{if(!e||!Array.isArray(e))return"";const l=[];return e.forEach((e=>l.push(e.name))),a?a+","+l.join(","):l.join(",")},g=(e,a)=>{let l={};return"status"===e.type&&(l="1"===a?{color:t[0]}:{color:t[1]}),l},O=(e,a)=>{let l="";return"status"===e.type&&(l="1"===a?"yuanLv":"yuanHui"),l},I=(e,a)=>{let l="";return"status"===e.type&&(l="1"===a?"启用":"停用"),l};return(e,a)=>{const t=n;return m(),c("div",Y,[N(t,{label:"基本信息"}),y("div",z,[y("div",W,[y("div",C,[(m(!0),c(E,null,b(f(r),(a=>(m(),c("div",{class:"cont-list",style:v(a.lineStyle),key:a.label},[y("div",$,T(e.$t(a.label))+"： ",1),y("div",{class:"cont-list-value",style:v(a.valStyle)},[a.iconPath?(m(),c("img",{key:0,src:l.value[a.iconPath],style:v(a.iconStyle)},null,12,K)):A("",!0),S(" "+T(a.value),1)],4)],4)))),128))])])])])}}}),[["__scopeId","data-v-87eaee9d"]]),X={class:"flow-detail"},Z={name:"FlowDetail"},ee=l(Object.assign(Z,{props:{importParams:{type:Object,default:()=>({})}},setup(e){const a=e,l=u({}),r=u(null);return p((()=>{t.flowDetail({modelId:a.importParams.modelId,definitionId:a.importParams.definitionId,edit:!0}).then((async e=>{r.value=null,g((()=>{r.value=e.data.data}))}))})),(e,a)=>{const t=n,o=k;return m(),c("div",X,[N(t,{label:"审批流程"}),r.value?(m(),M(o,h({key:0,id:"flow"},{readable:!0,mapable:!1,scroll:!1,scrollY:!1,top:"50"},{node:r.value,wrapStyle:l.value}),null,16,["node","wrapStyle"])):A("",!0)])}}}),[["__scopeId","data-v-e5d8fa81"]]),ae={name:"RecordTable"},le=l(Object.assign(ae,{props:{requestObj:{type:Object,defatult:()=>({})}},setup(e){const a=e,l=u([]),t=u(!1),o=d({get:()=>a.requestObj.tableHeaders[a.requestObj.value]});return p((()=>{t.value=!0,x[a.requestObj.modulesName][a.requestObj.urlName](a.requestObj.params).then((e=>{e.data&&(l.value=e.data),t.value=!1})).catch((()=>{t.value=!1}))})),(e,a)=>{const n=O("el-table-column"),s=r;return m(),M(s,{data:l.value,loading:t.value,ref:"recordTableRef",highlightCurrentRow:!0,class:"table"},{default:I((()=>[N(n,{type:"index",label:"序号",width:"60"}),(m(!0),c(E,null,b(f(o),(a=>(m(),M(n,{key:a.prop,prop:a.prop,width:a.width},{header:I((()=>[S(T(e.$t(a.label)),1)])),_:2},1032,["prop","width"])))),128))])),_:1},8,["data","loading"])}}}),[["__scopeId","data-v-2615465a"]]),te={name:"VersionTable"},re=l(Object.assign(te,{props:{requestObj:{type:Object,defatult:()=>({})}},setup(e){const a=e,l=u([]),t=u(!1),o=d({get:()=>a.requestObj.tableHeaders[a.requestObj.value]});return p((()=>{t.value=!0,x[a.requestObj.modulesName][a.requestObj.urlName](a.requestObj.params).then((e=>{e.data&&(l.value=e.data),t.value=!1})).catch((()=>{t.value=!1}))})),(e,a)=>{const n=O("el-table-column"),s=r;return m(),M(s,{data:l.value,loading:t.value,ref:"versionTableRef",highlightCurrentRow:!0,class:"table"},{default:I((()=>[N(n,{type:"index",label:"序号",width:"60"}),(m(!0),c(E,null,b(f(o),(a=>(m(),M(n,{key:a.prop,prop:a.prop,width:a.width},{header:I((()=>[S(T(e.$t(a.label)),1)])),_:2},1032,["prop","width"])))),128))])),_:1},8,["data","loading"])}}}),[["__scopeId","data-v-54566026"]]),oe={key:0},ne={name:"DetailDrawer"},se=Object.assign(ne,{props:{modelValue:{type:Boolean,defult:!1},modulesName:{type:String,default:""},detailParams:{type:Array,default:()=>[]},importParams:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(a,{emit:l}){const t=a,r={BaseInfo:J,FlowDetail:ee,VersionTable:re,RecordTable:le},n=u({urlName:"",params:"",modulesName:""}),s=q.findIndex((e=>e[t.modulesName])),i=q[s][t.modulesName],p=_({...i,componentList:[],componentName:"",updateActive:!1}),y=u(p.TABS.length>0&&p.TABS[0].value),T=d({get:()=>t.modelValue,set(e){l("update:modelValue",e)}}),S=u(0),h=()=>{if(0===p.componentList.length)return!1;return-1!==p.componentList.findIndex((e=>e.value===y.value))},g=e=>{const a=p.componentList;return e&&Array.isArray(e.children)?(0===p.componentList.length?e.children.forEach((l=>{a.push({value:e.value,copName:l})})):e.children.forEach((l=>{-1===a.findIndex((e=>e.copName===l))&&a.push({value:e.value,copName:l})})),a):[]},O=()=>{const{urlName:e,value:a}=p.URLS.find((e=>e.value===y.value)),l=t.detailParams.find((e=>e.value===y.value));n.value={value:a,urlName:e,params:l.params,modulesName:t.modulesName,info:p.INFO,tableHeaders:p.TABLEHEADERS}};return L((()=>t.modelValue),(e=>{e?(y.value=p.TABS.length>0&&p.TABS[0].value,O()):(p.componentList=[],p.updateActive=!1,y.value=null)})),L((()=>y.value),(()=>{!h()&&y.value&&(t.modelValue&&O(),(()=>{S.value=p.TABS.findIndex((e=>e.value===y.value));const e=p.TABS[S.value];e.value===y.value&&(0!==p.componentList.length&&h()||(p.componentList=g(e)),p.updateActive=!0)})())}),{immediate:!0}),(l,t)=>{const s=e;return m(),M(s,{modelValue:f(T),"onUpdate:modelValue":t[1]||(t[1]=e=>j(T)?T.value=e:null),direction:"rtl",onClose:l.clickClose,title:"详情",class:"detail-drawer",size:"800px"},{default:I((()=>[N(o,{active:y.value,label:f(p).TABS,"onUpdate:active":t[0]||(t[0]=e=>y.value=e),border:!0},null,8,["active","label"]),f(p).updateActive?(m(),c("div",oe,[(m(!0),c(E,null,b(f(p).componentList,((e,l)=>(m(),c("div",{key:l},[(m(),M(R(r[e.copName]),{requestObj:n.value,importParams:a.importParams,style:v({display:e.value===y.value?"block":"none"})},null,8,["requestObj","importParams","style"]))])))),128))])):A("",!0)])),_:1},8,["modelValue","onClose"])}}});export{se as _};
