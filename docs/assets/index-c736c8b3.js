import{aA as e,ay as a,ag as l,aF as s,as as t,o as i,p as d,aT as r,a$ as o,F as n,aD as u,m as c,bj as p,x as m,bl as v,w as f,n as h,v as g,ab as b,bb as _,aw as y,at as k}from"./chunk-vue-0eb5cee7.js";import{_ as w}from"./back-9f3fbace.js";import{g as x,p as I,D as F,t as V,E as L,e as j,F as N}from"./chunk-vform-c3afb8ec.js";import{V as E}from"./VerificationBtn-fd4a984d.js";import{a as C}from"./navbar-bdd97957.js";import{E as U}from"./chunk-element-plus-b8773542.js";import"./chunk-ant-design-vue-bd7f8294.js";import"./chunk-@ant-design-icons-svg-8f5189a2.js";import"./chunk-@ant-design-icons-vue-ff9a333c.js";const M=e=>(y("data-v-85dcc1bb"),e=e(),k(),e),T={class:"personall-container"},q={key:0,class:"head"},z=M((()=>d("span",{class:"title"},"个人中心",-1))),G={class:"cont"},Z={class:"info"},D={class:"user"},A={class:"user-msg"},S={class:"user-name"},B={class:"user-phone"},O={class:"phone-item"},$=M((()=>d("div",{class:"label"},"手机号:",-1))),P={class:"number"},R=M((()=>d("div",{class:"right-line"},null,-1))),H={class:"phone-item"},J=M((()=>d("div",{class:"label"},"邮箱:",-1))),K={class:"number"},Q=g('<div class="back-img" data-v-85dcc1bb><svg width="296" height="120" viewBox="0 0 296 120" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-85dcc1bb><mask id="mask0_2802_81596" style="mask-type:alpha;" maskUnits="userSpaceOnUse" x="0" y="0" width="296" height="120" data-v-85dcc1bb><rect width="296" height="120" rx="2" fill="#F1F4F8" data-v-85dcc1bb></rect></mask><g mask="url(#mask0_2802_81596)" data-v-85dcc1bb><path d="M148.393 -31.4769L295.998 35.3846L145.608 104.272L-1.99775 37.4108L148.393 -31.4769Z" fill="url(#paint0_linear_2802_81596)" data-v-85dcc1bb></path><path d="M-2 37.4111L145.607 104.274V265.354H-2V37.4111Z" fill="url(#paint1_linear_2802_81596)" data-v-85dcc1bb></path><path d="M296 35.3877L145.607 104.277V265.356H293.215L296 35.3877Z" fill="#EDEDED" data-v-85dcc1bb></path></g><defs data-v-85dcc1bb><linearGradient id="paint0_linear_2802_81596" x1="147" y1="99.7167" x2="147" y2="-29.9573" gradientUnits="userSpaceOnUse" data-v-85dcc1bb><stop stop-color="white" data-v-85dcc1bb></stop><stop offset="0.702553" stop-color="white" stop-opacity="0" data-v-85dcc1bb></stop></linearGradient><linearGradient id="paint1_linear_2802_81596" x1="145.607" y1="151.889" x2="-41.6869" y2="151.889" gradientUnits="userSpaceOnUse" data-v-85dcc1bb><stop stop-color="#F0F0F0" data-v-85dcc1bb></stop><stop offset="0.80732" stop-color="#EEEEEE" stop-opacity="0" data-v-85dcc1bb></stop></linearGradient></defs></svg></div>',1),W={class:"cont-box"},X={class:"label"},Y={class:"column"},ee=M((()=>d("div",{class:"label"},"角色 :",-1))),ae={key:0},le=M((()=>d("div",{class:"label"},"职位 :",-1))),se={class:"column"},te=M((()=>d("div",{class:"label"},"工号 :",-1))),ie={class:"column"},de=M((()=>d("div",{class:"label"},"人脸图片 :",-1))),re={class:"column"},oe=M((()=>d("div",null,null,-1))),ne=M((()=>d("div",{class:"tips"},[d("div",null,"提示"),d("div",null,"1:支持上传JPG/JPEG/PNG格式的人脸图片，大小不超过5M"),d("div",null,"2:请尽量保证人脸图形完整清晰，没有遮挡")],-1))),ue=M((()=>d("div",{class:"from-label"},"已绑定手机号",-1))),ce=M((()=>d("div",{class:"from-label"},"新手机号",-1))),pe=M((()=>d("div",{class:"from-label"},"验证码",-1))),me=f(" 提交 "),ve=f("取消"),fe=M((()=>d("div",{class:"from-label"},"已绑定邮箱",-1))),he=M((()=>d("div",{class:"from-label"},"新邮箱",-1))),ge=f(" 提交 "),be=f("取消"),_e=x({setup(g){const y=e(null),k=e({"zgj-token":I().token}),x=a({phone:"",code:""}),M=a({email:""}),_e=e(null),ye=e(null),ke=(e,a)=>{qe.userFaceImage=a.url},we=(e,a,l)=>{L(e)},xe=e=>"image/jpeg"!==e.type&&"image/png"!==e.type&&"image/jpg"!==e.type?(U.error("请上传格式为jpg、jpeg、png的人脸图片"),!1):!(e.size/1024/1024>5)||(U.error("人脸图片最多支持5MB"),!1),Ie=()=>{j.go(-1)},Fe=e(!1),Ve=e(!1),Le=()=>{Ve.value=!0,b((()=>{ye.value.resetFields(),M.email=""}))},je=e=>{Ve.value=!1},Ne=()=>{ye.value.validate((e=>{if(!e)return!1;C.changeEmail(M.email).then((e=>{Ve.value=!1,U.success("更改邮箱成功!"),Ge()}))}))},Ee=()=>{Fe.value=!0,b((()=>{_e.value.resetFields(),x.phone="",x.code=""}))},Ce=e=>{Fe.value=!1},Ue=()=>{_e.value.validate((e=>{if(!e)return!1;C.changeMobile({phone:x.phone,code:x.code}).then((e=>{Fe.value=!1,U.success("更改手机号成功!"),Ge()}))}))},Me={width:"120px",height:"32px",fontSize:"14px"},Te=e(!1),qe=a({userId:"",userName:"",userTel:"",userMail:"",userTitle:"",userNo:"",userFaceImage:"",organInfoList:[],roleInfoList:[]}),ze=()=>{_e.value.validateField("phone",(async e=>{e&&C.sendChangeMobileVerificationCode({phone:x.phone,type:"LOGIN"}).then((e=>{y.value.countDown()})).catch((e=>{}))}))},Ge=()=>{C.getUserInfo().then((e=>{qe.userId=e.data.userId,qe.userName=e.data.userName,qe.userTel=e.data.userTel,qe.userMail=e.data.userMail,qe.userTitle=e.data.userTitle,qe.userNo=e.data.userNo,qe.userFaceImage=e.data.userFaceImage?N+e.data.userFaceImage:"",qe.organInfoList=e.data.organInfoList,qe.roleInfoList=e.data.roleInfoList,Te.value=!0})).catch((e=>{Te.value=!0}))},Ze=()=>{},De=()=>{};return l((()=>{Ge()})),(e,a)=>{const l=s("el-col"),g=s("el-row"),b=s("el-image"),I=s("el-icon"),L=s("el-upload"),j=s("el-form-item"),N=s("el-input"),C=s("el-form"),U=s("el-button");return t(),i("div",T,[Te.value?(t(),i("div",q,[d("img",{class:"img",src:w,alt:"",onClick:Ie}),z,d("div",G,[d("div",Z,[d("div",D,r(o(qe).userName&&o(qe).userName.substr(1)),1),d("div",A,[d("div",S,r(o(qe).userName),1),d("div",B,[d("div",O,[$,d("div",P,r(o(qe).userTel||"-"),1),d("div",{class:"change",onClick:Ee},"更换")]),R,d("div",H,[J,d("div",K,r(o(qe).userMail||"-"),1),d("div",{class:"change",onClick:Le},"更换")])])]),Q]),d("div",W,[(t(!0),i(n,null,u(o(qe).organInfoList,((e,a)=>(t(),c(g,{class:"row",key:a},{default:p((()=>[m(l,{span:2,style:{"min-width":"100px"}},{default:p((()=>[v(d("div",X,"所属部门 :",512),[[_,0===a]])])),_:2},1024),m(l,{span:16},{default:p((()=>[d("div",Y,r(e.organName),1)])),_:2},1024)])),_:2},1024)))),128)),m(g,{class:"row"},{default:p((()=>[m(l,{span:2,style:{"min-width":"100px"}},{default:p((()=>[ee])),_:1}),m(l,{span:16},{default:p((()=>[(t(!0),i(n,null,u(o(qe).roleInfoList,((e,a)=>(t(),i("span",{class:"column",key:a},[f(r(e.roleName)+" ",1),a!==o(qe).roleInfoList.length-1?(t(),i("span",ae," 、 ")):h("",!0)])))),128))])),_:1})])),_:1}),m(g,{class:"row"},{default:p((()=>[m(l,{span:2,style:{"min-width":"100px"}},{default:p((()=>[le])),_:1}),m(l,{span:16},{default:p((()=>[d("div",se,r(o(qe).userTitle),1)])),_:1})])),_:1}),m(g,{class:"row"},{default:p((()=>[m(l,{span:2,style:{"min-width":"100px"}},{default:p((()=>[te])),_:1}),m(l,{span:16},{default:p((()=>[d("div",ie,r(o(qe).userNo),1)])),_:1})])),_:1}),m(g,{class:"row"},{default:p((()=>[m(l,{span:2,style:{"min-width":"100px"}},{default:p((()=>[de])),_:1}),m(l,{span:16},{default:p((()=>[d("div",re,[m(L,{action:"/api/user/editUserCenterFace",headers:k.value,"show-file-list":!1,"list-type":"picture-card","on-success":ke,"on-error":we,"before-upload":xe,"on-preview":De,"on-remove":Ze},{default:p((()=>[o(qe).userFaceImage?(t(),c(b,{key:0,src:o(qe).userFaceImage,style:{padding:"6px"}},null,8,["src"])):(t(),c(I,{key:1},{default:p((()=>[m(o(F))])),_:1}))])),_:1},8,["headers"])])])),_:1})])),_:1}),m(g,null,{default:p((()=>[m(l,{span:2,style:{"min-width":"80px"}},{default:p((()=>[oe])),_:1}),m(l,{span:16},{default:p((()=>[ne])),_:1})])),_:1})])]),m(V,{title:"更换手机号",modelValue:Fe.value,"onUpdate:modelValue":a[2]||(a[2]=e=>Fe.value=e),width:600,height:220},{footer:p((()=>[m(U,{type:"primary",onClick:Ue},{default:p((()=>[me])),_:1}),m(U,{onClick:Ce},{default:p((()=>[ve])),_:1})])),default:p((()=>[m(C,{"label-position":"left",ref_key:"loginformRef",ref:_e,"label-width":"100px",model:o(x),"hide-required-asterisk":""},{default:p((()=>[m(j,null,{label:p((()=>[ue])),default:p((()=>[d("div",null,r(o(qe).userTel),1)])),_:1}),m(j,{prop:"phone",required:"",rules:[{required:!0,message:"请输入正确的手机号",pattern:/^1(3[0-9]|4[01456879]|5[0-35-9]|6[2567]|7[0-8]|8[0-9]|9[0-35-9])\d{8}$/,trigger:"change"}]},{label:p((()=>[ce])),default:p((()=>[m(N,{modelValue:o(x).phone,"onUpdate:modelValue":a[0]||(a[0]=e=>o(x).phone=e),placeholder:"请输入",style:{width:"210px"},maxlength:"11",oninput:"value=value.replace(/^\\.+|[^\\d.]/g,'')"},null,8,["modelValue"])])),_:1},8,["rules"]),m(j,{class:"clearfix",label:"验证码",prop:"code",required:"",rules:[{required:!0,message:"验证码是6位数字",trigger:"change",pattern:/^\d{6}$/}]},{label:p((()=>[pe])),default:p((()=>[m(N,{modelValue:o(x).code,"onUpdate:modelValue":a[1]||(a[1]=e=>o(x).code=e),placeholder:"请输入验证码",style:{width:"210px"},maxlength:"6",oninput:"value=value.replace(/^\\.+|[^\\d.]/g,'')"},null,8,["modelValue"]),m(E,{customStyle:Me,customClick:!0,onCustomClickFn:ze,ref_key:"verificationBtn",ref:y},null,512)])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),m(V,{title:"更换邮箱",modelValue:Ve.value,"onUpdate:modelValue":a[4]||(a[4]=e=>Ve.value=e),width:600,height:100},{footer:p((()=>[m(U,{type:"primary",onClick:Ne},{default:p((()=>[ge])),_:1}),m(U,{onClick:je},{default:p((()=>[be])),_:1})])),default:p((()=>[m(C,{"label-position":"left",ref_key:"loginEmailformRef",ref:ye,"label-width":"100px",model:o(M),"hide-required-asterisk":""},{default:p((()=>[m(j,null,{label:p((()=>[fe])),default:p((()=>[d("div",null,r(o(qe).userMail||"暂未绑定邮箱"),1)])),_:1}),m(j,{prop:"email",required:"",rules:[{required:!0,message:"邮箱格式不正确",pattern:/^[a-z0-9A-Z]+[-|a-z0-9A-Z._]+@([a-z0-9A-Z]+(-[a-z0-9A-Z]+)?\.)+[a-z]{2,}$/,trigger:"change"}]},{label:p((()=>[he])),default:p((()=>[m(N,{modelValue:o(M).email,"onUpdate:modelValue":a[3]||(a[3]=e=>o(M).email=e),placeholder:"请输入",style:{width:"210px"}},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["model"])])),_:1},8,["modelValue"])])):h("",!0)])}}},[["__scopeId","data-v-85dcc1bb"]]);export{_e as default};
