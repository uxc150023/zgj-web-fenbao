import e from"./index-6dab3ed3.js";import{J as a}from"./JyTable-f9beb232.js";import{a as o}from"./actionOneDialog-00cd89b8.js";import{a as t}from"./actionMoreDialog-4742089f.js";import{g as s,j as l,a3 as n}from"./chunk-vform-c3afb8ec.js";import{a as i}from"./businessRule-67692406.js";import{_ as r}from"./index-c8bf9a45.js";import{aA as u,ay as d,al as h,aF as m,as as p,o as g,x as c,bj as w,p as D,w as y,aT as B,a$ as T,aw as f,at as b}from"./chunk-vue-0eb5cee7.js";import"./chunk-element-plus-b8773542.js";import"./chunk-ant-design-vue-bd7f8294.js";import"./chunk-@ant-design-icons-svg-8f5189a2.js";import"./chunk-@ant-design-icons-vue-ff9a333c.js";import"./sangedian-856844bf.js";import"./Layout-442da1ba.js";import"./searchForm-3ad5f987.js";import"./ketanchude-51586196.js";import"./KDocumentTypeDialog-5d4bd993.js";import"./pagination-a44416c5.js";import"./batch-2cbdc416.js";import"./index-d67b578f.js";import"./index-842d8ec6.js";import"./cha-kong-4b498f35.js";import"./index-af5739e4.js";import"./yuan-hui-61924fee.js";import"./index-b6bf8664.js";import"./home-back-8683dc83.js";import"./logo-55df0058.js";import"./request-util-c02431a4.js";const j=[{prop:"ruleBusinessName",label:"业务规则名称","min-width":150,fixed:"left",show:!0},{prop:"ruleBusinessNo",label:"业务规则编码",width:180,align:"center",show:!0},{prop:"fileTypeName",label:"文件类型","min-width":180,show:!0},{prop:"sealUseTypeName",label:"用印类型",align:"center",width:120,show:!0},{prop:"flag",label:"状态",sortable:"custom",align:"center",width:120,show:!0},{prop:"modifyDatetime",label:"更新时间",sortable:"custom",align:"center",width:180,show:!0},{prop:"createUserName",label:"创建人",align:"center","min-width":150,show:!0},{prop:"caozuo",label:"操作",width:280,fixed:"right",align:"center",show:!0,rankDisplayData:[{name:"t-zgj-Edit"},{name:"t-zgj-Delete"},{name:"status"},{name:"t-zgj-qyWechat.Copy"}]}],C=e=>(f("data-v-ec9c8c16"),e=e(),b(),e),x={class:"title"},v=C((()=>D("div",null,"业务规则配置",-1))),E={class:"title-more"},M={class:"title-more-add"},J=y(" 业务规则复制 "),k=C((()=>D("div",{class:"from-label"},"业务规则名称",-1))),N=y(" 提交 "),F=y("取消"),I=s({setup(s){const f=u(!1),b=u([]),C=l(),I=d({componentsSearchForm:{data:[{id:"keyword",label:"关键词",type:"input",inCommonUse:!0,defaultAttribute:{placeholder:"业务规则名称/业务规则编码/创建人"}},{id:"flag",label:"状态",type:"select",inCommonUse:!0,defaultAttribute:{placeholder:"请选择"},options:[{value:"1",label:"启用"},{value:"0",label:"停用"}]},{id:"updateTime",label:"更新时间",type:"picker",inCommonUse:!1,requestType:"array",startRequest:"updateStartTime",endRequest:"updateEndTime",defaultAttribute:{type:"daterange","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD","disabled-date":e=>e.getTime()>Date.now(),"default-value":[new Date((new Date).setMonth((new Date).getMonth()-1)),new Date]},style:{}},{id:"sealUseTypeId",label:"用印类型",type:"select",inCommonUse:!1,defaultAttribute:{placeholder:"请选择"},options:[{value:"1",label:"物理用印"},{value:"2",label:"电子签章"}]},{id:"fileTypeId",requestParams:"fileTypeId",label:"文件类型",type:"derivable",inCommonUse:!1,defaultAttribute:{placeholder:"请选择",type:"fileType",multiple:!0,joinStr:","},options:[]}],butData:[{id:"more",name:"展开",type:"unfold",defaultAttribute:{type:"primary"},style:{}},{id:"inquire",name:"查询",type:"click",defaultAttribute:{type:"primary"},style:{}},{id:"reset",name:"重置",type:"click",defaultAttribute:{},style:{}}]},componentsTable:{header:j},componentsBatch:{selectionData:[],defaultAttribute:{disabled:!0},data:[{name:"t-zgj-seal.BatchDelete"},{name:"t-zgj-dept.BatchEnable"},{name:"t-zgj-dept.BatchDeactivation"}]},JyElMessageBox:{type:"",id:"",flag:"",show:!1,header:{data:""},content:{data:""}},showToastDialog:{curKey:"",type:"",show:!1,header:{data:""},content:{data:""}},showFormDialog:{show:!1,header:{data:"业务规则复制"},content:{data:""},ruleBusinessName:""},showToastDialogContent:{show:!1,header:"",content:"",selectionTableData:{headers:[{prop:"fileTypeName",label:"文件类型",align:"center"},{prop:"ruleBusinessName",label:"关联业务规则(已启用)",align:"center"}],data:[]}}}),z=u(null),V=u(null),U=()=>{C.push({name:"EditBusinessRule"})};function _(e,a,o,t){"ruleBusinessName"===a.property&&(f.value=!0,b.value=[{value:"detail",params:e.ruleBusinessId},{value:"record",params:{operationId:""}}])}function A(e,a,o,t){"t-zgj-Edit"===o.name&&C.push({name:"EditBusinessRule",query:{ruleBusinessId:a.ruleBusinessId}}),"t-zgj-Delete"===o.name&&(I.JyElMessageBox.type=o.name,I.JyElMessageBox.id=a.ruleBusinessId,I.JyElMessageBox.header.data="提示？",I.JyElMessageBox.content.data="您确定要删除该记录吗？",I.JyElMessageBox.show=!0),"status"===o.name&&(I.JyElMessageBox.type=o.name,I.JyElMessageBox.flag=a.flag,I.JyElMessageBox.id=a.ruleBusinessId,I.JyElMessageBox.header.data="提示？",I.JyElMessageBox.content.data=`您确定要${"1"===a.flag?"停用":"启用"}该记录吗？`,I.JyElMessageBox.show=!0),"t-zgj-qyWechat.Copy"===o.name&&(I.showFormDialog.show=!0,I.showFormDialog.id=a.ruleBusinessId,I.showFormDialog.ruleBusinessName=a.ruleBusinessName+" - 副本")}const q=()=>{V.value.validate((e=>{e&&i.ruleCopy({ruleBusinessId:I.showFormDialog.id,ruleBusinessName:I.showFormDialog.ruleBusinessName}).then((()=>{n("复制成功"),I.showFormDialog.show=!1,z.value.reloadData()}))}))},S=()=>{I.showFormDialog.show=!1},K=()=>{"t-zgj-Delete"===I.JyElMessageBox.type?i.ruleBatchDelete({ruleBusinessIds:[I.JyElMessageBox.id]}).then((()=>{n("删除成功"),z.value.reloadData()}),(e=>{e.data&&(I.showToastDialogContent.show=!0)})).finally((()=>{I.JyElMessageBox.show=!1})):"status"===I.JyElMessageBox.type&&i.ruleDisable({ruleBusinessId:I.JyElMessageBox.id,flag:"1"===I.JyElMessageBox.flag?"0":"1"}).then((()=>{n("1"===I.JyElMessageBox.flag?"停用成功":"启用成功"),z.value.reloadData()}),(e=>{e.data&&(I.showToastDialogContent.show=!0,I.showToastDialogContent.header="1"===I.JyElMessageBox.flag?"停用失败":"启用失败",I.showToastDialogContent.content="当前业务规则中关联的一下文件类型已用于其他已启用的业务规则，请确保一个文件类型仅关联一个已启用的业务规则",I.showToastDialogContent.selectionTableData.data=e.data)})).finally((()=>{I.JyElMessageBox.show=!1}))},R=(e,a)=>{I.componentsBatch.selectionData=a,"t-zgj-seal.BatchDelete"===e.name?(I.showToastDialog.show=!0,I.showToastDialog.type=e.name,I.showToastDialog.curKey="ruleBusinessName",I.showToastDialog.header={data:"批量删除"},I.showToastDialog.content={data:"是否删除以下业务规则？"}):"t-zgj-dept.BatchEnable"===e.name?(I.showToastDialog.show=!0,I.showToastDialog.type=e.name,I.showToastDialog.curKey="ruleBusinessName",I.showToastDialog.header={data:"批量启用"},I.showToastDialog.content={data:"是否启用以下业务规则？"}):"t-zgj-dept.BatchDeactivation"===e.name&&(I.showToastDialog.show=!0,I.showToastDialog.type=e.name,I.showToastDialog.curKey="ruleBusinessName",I.showToastDialog.header={data:"批量停用"},I.showToastDialog.content={data:"是否停用以下业务规则？"})},P=()=>{"t-zgj-seal.BatchDelete"===I.showToastDialog.type?i.ruleBatchDelete({ruleBusinessIds:I.componentsBatch.selectionData.map((e=>e.ruleBusinessId))}).then((()=>{n("删除成功"),z.value.reloadData()}),(e=>{e.data&&(I.showToastDialogContent.show=!0,I.showToastDialogContent.header="删除失败",I.showToastDialogContent.content=e.msg,I.showToastDialogContent.selectionTableData.data=e.data)})).finally((()=>{I.showToastDialog.show=!1})):"t-zgj-dept.BatchEnable"===I.showToastDialog.type?i.ruleBatchEnable({ruleBusinessIds:I.componentsBatch.selectionData.map((e=>e.ruleBusinessId))}).then((()=>{n("启用成功"),z.value.reloadData()}),(e=>{e.data&&(I.showToastDialogContent.show=!0,I.showToastDialogContent.header="启用失败",I.showToastDialogContent.content=e.msg,I.showToastDialogContent.selectionTableData.data=e.data)})).finally((()=>{I.showToastDialog.show=!1})):"t-zgj-dept.BatchDeactivation"===I.showToastDialog.type&&i.ruleBatchDisable({ruleBusinessIds:I.componentsBatch.selectionData.map((e=>e.ruleBusinessId))}).then((()=>{n("停用成功"),z.value.reloadData()}),(e=>{e.data&&(I.showToastDialogContent.show=!0,I.showToastDialogContent.header="停用失败",I.showToastDialogContent.content=e.msg,I.showToastDialogContent.selectionTableData.data=e.data)})).finally((()=>{I.showToastDialog.show=!1}))};return h((()=>{})),(s,l)=>{const n=m("el-button"),i=m("el-input"),u=m("el-form-item"),d=m("el-form"),h=m("JyElMessageBox"),j=e;return p(),g("div",null,[c(a,{url:"/biz/rule/page",ref_key:"table",ref:z,method:"POST",componentsSearchForm:T(I).componentsSearchForm,componentsTableHeader:T(I).componentsTable.header,componentsBatch:T(I).componentsBatch,tableClick:"ruleBusinessName",statusColoum:"flag",openValue:"1",onCellClick:_,onCustomClick:A,onClickBatchButton:R},{title:w((()=>[D("div",x,[v,D("div",E,[D("div",M,[c(n,{type:"primary",onClick:U},{default:w((()=>[y("+ "+B(s.$t("t-zgj-add")),1)])),_:1})])])])])),_:1},8,["componentsSearchForm","componentsTableHeader","componentsBatch"]),c(r,{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=e=>f.value=e),modulesName:"rule_business_management",detailParams:b.value},null,8,["modelValue","detailParams"]),c(o,{modelValue:T(I).JyElMessageBox.show,"onUpdate:modelValue":[l[1]||(l[1]=e=>T(I).JyElMessageBox.show=e),T(I).JyElMessageBox.show],JyElMessageBox:T(I).JyElMessageBox,onSubmitElMessageBox:K},null,8,["modelValue","JyElMessageBox","onUpdate:modelValue"]),c(T(t),{"onUpdate:modelValue":l[2]||(l[2]=e=>T(I).showToastDialog.show=!1),show:T(I).showToastDialog.show,selectionData:T(I).componentsBatch.selectionData,showToastDialogContent:T(I).showToastDialog,label:"formName",onSureAction:P,curKey:T(I).showToastDialog.curKey},null,8,["show","selectionData","showToastDialogContent","curKey"]),c(h,{modelValue:T(I).showFormDialog.show,"onUpdate:modelValue":l[4]||(l[4]=e=>T(I).showFormDialog.show=e),show:T(I).showFormDialog.show,defaultAttribute:{}},{header:w((()=>[J])),content:w((()=>[c(d,{ref_key:"formRef",ref:V,"label-position":"left","label-width":"100px",model:T(I).showFormDialog,"hide-required-asterisk":""},{default:w((()=>[c(u,{prop:"ruleBusinessName",rules:[{required:!0,message:"业务规则名称不能为空",trigger:"change"}]},{label:w((()=>[k])),default:w((()=>[c(i,{modelValue:T(I).showFormDialog.ruleBusinessName,"onUpdate:modelValue":l[3]||(l[3]=e=>T(I).showFormDialog.ruleBusinessName=e),placeholder:"请输入",style:{width:"210px"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),footer:w((()=>[c(n,{type:"primary",onClick:q},{default:w((()=>[N])),_:1}),c(n,{onClick:S},{default:w((()=>[F])),_:1})])),_:1},8,["modelValue","show"]),c(j,{show:T(I).showToastDialogContent.show,showToastDialogContent:T(I).showToastDialogContent,"onUpdate:modelValue":l[5]||(l[5]=e=>T(I).showToastDialogContent.show=!1)},null,8,["show","showToastDialogContent"])])}}},[["__scopeId","data-v-ec9c8c16"]]);export{I as default};
