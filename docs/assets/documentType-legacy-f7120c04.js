!function(){function e(e,a,t){return(a=function(e){var a=function(e,a){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var l=t.call(e,a||"default");if("object"!=typeof l)return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(e,"string");return"symbol"==typeof a?a:String(a)}(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}System.register(["./index-legacy-6ac6c165.js","./tree-legacy-b6bec693.js","./documentsDetails-legacy-e16e1c33.js","./chunk-vform-legacy-c59809de.js","./actionMoreDialog-legacy-ba0c1041.js","./chunk-vue-legacy-ac482c0f.js","./JyTable-legacy-1eb202db.js","./chunk-element-plus-legacy-93ba4a6a.js","./chunk-ant-design-vue-legacy-1182637d.js","./chunk-@ant-design-icons-svg-legacy-99a059a7.js","./chunk-@ant-design-icons-vue-legacy-38d6bf6a.js","./tree.vue_vue_type_style_index_0_scoped_c843ec9b_lang-legacy-4d311a3e.js","./cha-kong-legacy-279cd6dc.js","./JyTabs-legacy-3265f38a.js","./JyTabs.vue_vue_type_style_index_0_scoped_5e06bfe2_lang-legacy-bb1152fe.js","./table-legacy-3a211901.js","./sangedian-legacy-1dcf1313.js","./documentsDetails.vue_vue_type_style_index_0_scoped_204b6fa9_lang-legacy-72ae079a.js","./portion-legacy-a4073e2e.js","./portion.vue_vue_type_style_index_0_scoped_3abd16ad_lang-legacy-f62a108a.js","./yuan-hui-legacy-2a507678.js","./Layout-legacy-06b00f84.js","./searchForm-legacy-d255e433.js","./ketanchude-legacy-190a1e99.js","./KDocumentTypeDialog-legacy-603b2f75.js","./pagination-legacy-9ca6ffcd.js","./batch-legacy-77d389cd.js","./index-legacy-d26760d0.js"],(function(a,t){"use strict";var l,o,n,d,i,s,u,r,c,p,m,y,f,h,g,v,T,b,w,_,D,x,V,k,j,M,I,C,B,P,S,F,N=document.createElement("style");return N.textContent='.privacy-set-form .el-dialog__body{display:flex;justify-content:center}.fileManagement-documentType[data-v-9eb8dd83]{margin:0%}.fileManagement-documentType .title[data-v-9eb8dd83]{display:flex;align-items:center;justify-content:space-between}.fileManagement-documentType .title .title-more[data-v-9eb8dd83]{height:100%;display:flex;align-items:center}.fileManagement-documentType .title .title-more .title-more-add[data-v-9eb8dd83]{margin-right:.5rem;height:100%;display:flex;align-items:center}.fileManagement-documentType .title .title-more .title-more-down[data-v-9eb8dd83]{height:100%;display:flex;align-items:center}.fileManagement-documentType .batch[data-v-9eb8dd83]{display:flex;align-items:center}.fileManagement-documentType .batch .batch-desc[data-v-9eb8dd83]{margin-right:.8571428571rem}.fileManagement-documentType .components-tree[data-v-9eb8dd83]{width:max-content;min-width:100%;margin:0%}.fileManagement-documentType .components-tree .custom-tree-node[data-v-9eb8dd83]{display:flex;align-items:center}.fileManagement-documentType .components-tree .custom-tree-node .custom-tree-node-icon[data-v-9eb8dd83]{margin-right:.4rem}.fileManagement-documentType .components-tree[data-v-9eb8dd83]{margin-bottom:0%}.fileManagement-documentType .components-tree[data-v-9eb8dd83] .el-tree-node__content{height:2.2857142857rem;padding-right:10px}.fileManagement-documentType .components-tree[data-v-9eb8dd83] .el-tree .el-icon svg{display:none!important;height:0;width:0}.fileManagement-documentType .components-tree[data-v-9eb8dd83] .el-tree-node__expand-icon{font-size:16px}.fileManagement-documentType .components-tree[data-v-9eb8dd83] .el-tree .el-tree-node__expand-icon.expanded{-webkit-transform:rotate(0deg);transform:rotate(0)}.fileManagement-documentType .components-tree[data-v-9eb8dd83] .el-tree .el-tree-node__expand-icon:before{background:url(/zgj-web-fenbao/assets/tree-fangxiang-zuo-449ab744.svg) no-repeat 0;content:"";display:block;width:18px;height:18px}.fileManagement-documentType .components-tree[data-v-9eb8dd83] .el-tree .el-tree-node__expand-icon.expanded:before{background:url(/zgj-web-fenbao/assets/tree-fangxiang-xia-767e704d.svg) no-repeat 0 0;content:"";display:block;width:18px;height:18px;margin-top:4px}.fileManagement-documentType .components-tree[data-v-9eb8dd83] .el-tree .is-leaf.el-tree-node__expand-icon:before{display:block;background:none!important;content:"";width:18px;height:18px}.fileManagement-documentType .components-tree[data-v-9eb8dd83] .el-tree-node__expand-icon.is-leaf{width:0px}\n',document.head.appendChild(N),{setters:[e=>{l=e.default},e=>{o=e.c},e=>{n=e.c},e=>{d=e.a7,i=e.a3,s=e.E,u=e.g,r=e.ae,c=e.H,p=e.a4,m=e.m},e=>{y=e.a},e=>{f=e.aA,h=e.k,g=e.aF,v=e.as,T=e.m,b=e.bj,w=e.x,_=e.a$,D=e.a4,x=e.w,V=e.ay,k=e.al,j=e.o,M=e.p,I=e.aT,C=e.n,B=e.F,P=e.aw,S=e.at},e=>{F=e.J},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){class t{constructor(){e(this,"fileTypeNo",""),e(this,"fileTypeName",""),e(this,"fileTypeSn",""),e(this,"fileTypePid","-1")}}class N{constructor(){e(this,"fileTypeIds",[])}}class U{constructor(){e(this,"fileTypeId",""),e(this,"organs",[]),e(this,"roles",[]),e(this,"users",[])}}class A{constructor(){e(this,"fileTypeId",""),e(this,"applicantPreview",""),e(this,"applicantDownload","")}}const J=x("提交"),E=x("取消"),O={name:"AddFileType"},q=Object.assign(O,{props:{modelValue:{type:Boolean,default:!1},optionsTree:{type:Array,default:()=>[]},curFromData:{type:Object,default:()=>{}},fileTypePid:{type:String,default:"-1"}},emits:["update:modelValue","refresh","on-closed"],setup(e,{emit:a}){const l=e,o=f(new t),n=f(null),u={fileTypeName:[{required:!0,message:"请输入",trigger:"blur"}]},r=h({get:()=>l.modelValue,set(e){a("update:modelValue",e)}}),c=async()=>{try{await n.value.validate(),o.value.fileTypePid||(o.value.fileTypePid="0"),o.value.fileTypeId?(await d.fileTypeEdit(o.value),i("文件类型修改成功")):(await d.fileTypeAdd(o.value),i("文件类型添加成功")),r.value=!1,o.value=new t,a("refresh")}catch(e){s(e)}},p=async()=>{try{if(l.curFromData.fileTypeId){const e=await await d.getFileTypeInfo(l.curFromData.fileTypeId);o.value={...o.value,...e.data}}else o.value.fileTypePid=l.fileTypePid,(async()=>{try{const e=await d.generateBizNo();o.value.fileTypeNo=e.data||""}catch(e){s(e)}})()}catch(e){s(e)}},m=()=>{r.value=!1},y=()=>{o.value=new t,a("on-closed")};return(a,t)=>{const d=g("el-input"),i=g("el-form-item"),s=g("el-tree-select"),f=g("el-form"),h=g("el-button"),x=g("JyDialog2");return v(),T(x,{title:e.curFromData.fileTypeId?"修改文件类型":"新增文件类型",modelValue:_(r),"onUpdate:modelValue":t[4]||(t[4]=e=>D(r)?r.value=e:null),onOnOpened:p,onOnClosed:y,height:220},{footer:b((()=>[w(h,{type:"primary",onClick:c},{default:b((()=>[J])),_:1}),w(h,{onClick:m},{default:b((()=>[E])),_:1})])),default:b((()=>[w(f,{ref_key:"formRef",ref:n,model:o.value,rules:u,"label-width":"120px",class:"demo-ruleForm"},{default:b((()=>[w(i,{label:"文件类型编码"},{default:b((()=>[w(d,{modelValue:o.value.fileTypeNo,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value.fileTypeNo=e),disabled:""},null,8,["modelValue"])])),_:1}),w(i,{label:"文件类型名称",prop:"fileTypeName"},{default:b((()=>[w(d,{modelValue:o.value.fileTypeName,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value.fileTypeName=e),clearable:"",maxlength:"128"},null,8,["modelValue"])])),_:1}),w(i,{label:"文件类型字号"},{default:b((()=>[w(d,{modelValue:o.value.fileTypeSn,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value.fileTypeSn=e),clearable:"",maxlength:"128"},null,8,["modelValue"])])),_:1}),w(i,{label:"上级文件夹"},{default:b((()=>[w(s,{modelValue:o.value.fileTypePid,"onUpdate:modelValue":t[3]||(t[3]=e=>o.value.fileTypePid=e),data:l.optionsTree,"check-strictly":"",style:{width:"100%"},props:{children:"child",label:"fileTypeName",disabled:e=>(e.fileTypeId===l.curFromData.fileTypeId||e.fileTypePid===l.curFromData.fileTypeId)&&"-1"!==e.fileTypeId},"value-key":"fileTypeId"},null,8,["modelValue","data","props"])])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"])}}}),R=x("提交"),z=x("取消"),L={name:"PrivacySet"},Y=Object.assign(L,{props:{modelValue:{type:Boolean,default:!1},optionsTree:{type:Array,default:()=>[]},fileTypeId:{type:String,default:""}},emits:["update:modelValue","refresh","on-closed"],setup(e,{emit:a}){const t=e,l=f(new A),o=f(null),n={fileTypeName:[{required:!0,message:"请输入",trigger:"blur"}]},u=h({get:()=>t.modelValue,set(e){a("update:modelValue",e)}}),r=async()=>{try{await d.privacySet(l.value),u.value=!1,l.value=new A,i("特殊类型隐私设置成功"),a("refresh")}catch(e){s(e)}},c=()=>{l.value.fileTypeId=t.fileTypeId,(async()=>{try{const e=await d.queryPrivacyByType(t.fileTypeId);l.value={...l.value,...e.data}}catch(e){s(e)}})()},p=()=>{u.value=!1},m=()=>{l.value=new A,a("on-closed")};return(e,a)=>{const t=g("el-switch"),d=g("el-form-item"),i=g("el-form"),s=g("el-button"),y=g("JyDialog2");return v(),T(y,{title:"特殊类型隐私配置",modelValue:_(u),"onUpdate:modelValue":a[2]||(a[2]=e=>D(u)?u.value=e:null),onOnOpened:c,onOnClosed:m,width:500,appendToBody:"",class:"privacy-set-form"},{footer:b((()=>[w(s,{type:"primary",onClick:r},{default:b((()=>[R])),_:1}),w(s,{onClick:p},{default:b((()=>[z])),_:1})])),default:b((()=>[w(i,{ref_key:"formRef",ref:o,model:l.value,rules:n},{default:b((()=>[w(d,{label:"用印单据上传附件仅申请人能预览",prop:"applicantPreview"},{default:b((()=>[w(t,{modelValue:l.value.applicantPreview,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value.applicantPreview=e),"active-value":"1","inactive-value":"0"},null,8,["modelValue"])])),_:1}),w(d,{label:"用印单据上传附件仅申请人能预览",prop:"applicantDownload"},{default:b((()=>[w(t,{modelValue:l.value.applicantDownload,"onUpdate:modelValue":a[1]||(a[1]=e=>l.value.applicantDownload=e),"active-value":"1","inactive-value":"0"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])}}}),H=e=>(P("data-v-9eb8dd83"),e=e(),S(),e),K={class:"fileManagement-documentType"},$={class:"title"},G=H((()=>M("div",null,"文件类型",-1))),Q={class:"title-more"},W={class:"title-more-add"},X=H((()=>M("div",{class:"title-more-down"},null,-1))),Z={class:"components-tree"},ee={class:"ap-box"},ae={name:"DocumentType"};a("default",u(Object.assign(ae,{setup(e){const a=f(!1),t=f(!1),s=f(new N),u=f(new r),h=f(!1),D=f(!1),P=f({}),S=f(""),A=f([]),J=f(new U),E=f([]),O=f(!1),R=f(null),z=f(null),L=f(null),H=f([]),ae=V({componentsSearchForm:{style:{lineStyle:{width:"calc(100% / 3)"},labelStyle:{width:"100px"}},data:[{id:"keyword",label:"关键词",type:"input",inCommonUse:!0,defaultAttribute:{placeholder:"请输入文件类型名称或编码"}},{id:"beginTime",label:"创建时间",type:"picker",inCommonUse:!0,defaultAttribute:{type:"daterange","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD","disabled-date":e=>e.getTime()>Date.now(),"default-value":[new Date((new Date).setMonth((new Date).getMonth()-1)),new Date]},style:{},requestType:"array"}],butData:[{id:"more",name:"展开",type:"unfold",defaultAttribute:{type:"primary"},style:{}},{id:"inquire",name:"查询",type:"click",defaultAttribute:{type:"primary"},style:{}},{id:"reset",name:"重置",type:"click",defaultAttribute:{},style:{}}]},componentsTable:{header:[{prop:"fileTypeNo",label:"文件类型编码",sortable:!0,show:!0,"min-width":150},{prop:"fileTypeName",label:"文件类型名称",sortable:!0,show:!0,"min-width":150},{prop:"level",label:"文件类型层级",sortable:!0,show:!0,"min-width":150},{prop:"fileSum",label:"文件数",sortable:!0,show:!0,"min-width":150},{prop:"createUser",label:"创建人",sortable:!0,show:!0,"min-width":150},{prop:"createDatetime",label:"创建时间",show:!0,sortable:!0,"min-width":180},{prop:"caozuo",label:"操作",fixed:"right",show:!0,width:350,rankDisplayData:[{name:"修改",code:1},{name:"删除",code:2},{name:"设置可见范围",code:3},{name:"特殊类型隐私配置",code:4}]}]},componentsTree:{data:[],defaultAttribute:{"check-on-click-node":!0,"show-checkbox":!1,"default-expand-all":!0,"expand-on-click-node":!1,"check-strictly":!0,"highlight-current":!0,"node-key":"fileTypeId","current-node-key":"-1"},defaultProps:{label:"fileTypeName",children:"child",isLeaf:"haveChildren",nodeKey:"fileTypeId"},value:""},componentsDocumentsDetails:{show:!1,visible:[{label:"文件详情",name:"Details-of-Document"},{label:"操作记录",name:"operating-record"}]},componentsBatch:{selectionData:[],defaultAttribute:{disabled:!0},data:[{name:"批量删除",code:1}]},JyElMessageBox:{show:!1,header:{data:""},content:{data:""}},showToastDialog:{show:!1,header:{data:"",icon:"/src/assets/svg/common/warning.svg"},content:{data:""}},showDeleteFTyle:{show:!1,header:{data:"",icon:"/src/assets/svg/common/warning.svg"},content:{data:""}}}),te=(e,a,t,l)=>{s.value.fileTypeIds=p([e],"child","fileTypeId"),R.value.reloadData()},le=()=>{(async()=>{try{D.value=!0;const e=await d.getFileTypeListPage({...s.value,...u});ae.componentsTable.data=e.data.records||[],u.value.total=e.data&&e.data.total,u.value.pages=e.data&&e.data.pages}catch(e){}D.value=!1})(),(async()=>{try{const e=await d.getTreeList({});ae.componentsTree.data=[],ae.componentsTree.data.push({fileTypeName:"文件类型",fileTypeId:"-1",child:e.data||[]}),ae.componentsTree.value="-1",R.value.reloadData()}catch(e){}})(),P.value={}},oe=async()=>{try{E.value.length?(await d.batchDelete({fileTypeIds:E.value}),i("批量删除成功"),ae.showToastDialog.show=!1):(await d.fileTypeDelete(S.value),i("成功删除文件类型"),ae.JyElMessageBox.show=!1),le()}catch(a){var e;if(a.code&&500===a.code&&null!==(e=a.data)&&void 0!==e&&e.length){ae.showToastDialog.show=!1,ae.JyElMessageBox.show=!1,ae.componentsBatch.selectionData=[],ae.showDeleteFTyle.show=!0;const e=H.value.filter((e=>a.data.includes(e.fileTypeId)));L.value={header:"删除失败",content:"以下文件类型已被使用，不允许删除，若文件类型被已启用的文件类型关联或者已发起用印申请，则认为被使用。",selectionData:e}}}},ne=async e=>{try{const l=await d.queryVisibleRByFileType(e),o=l.data.roles?l.data.roles:[],n=l.data.organs?l.data.organs:[],i=l.data.users?l.data.users:[];A.value=[...n,...o,...i],t.value=!0,setTimeout((()=>{a.value=!0}),50)}catch(l){}},de=()=>{a.value=!1,setTimeout((()=>{t.value=!1}),300)},ie=async e=>{e.forEach((a=>{"user"===a.type&&(J.value.users=e.filter((e=>"user"===e.type))),"organ"===a.type&&(J.value.organs=e.filter((e=>"organ"===e.type))),"role"===a.type&&(J.value.roles=e.filter((e=>"role"===e.type)))}));try{await d.viewRangSet(J.value);a.value=!1,i("可见范围设置成功")}catch(t){}},se=()=>{P.value={}},ue=async(e,a)=>{const t=R.value.getSelectionRows();E.value=t.map((e=>e.fileTypeId)),1===e.code&&(ae.componentsBatch.selectionData=a,z.value={header:{data:"批量删除"},content:{data:"是否删除以下文件类型？"}},ae.showToastDialog.show=!0),2===e.code&&m("待产品确认回显功能")};function re(e,a,t,l){"1"===a.property&&(ae.componentsDocumentsDetails.show=!0)}function ce(){ae.componentsDocumentsDetails.show=!1}function pe(e,a,t,l){S.value=a.fileTypeId,1===t.code&&(h.value=!0,P.value={...P.value,...a}),2===t.code&&(ae.JyElMessageBox.header.data="提示？",ae.JyElMessageBox.content.data="您确定要删除该记录吗？",ae.JyElMessageBox.show=!0),3===t.code&&(J.value.fileTypeId=a.fileTypeId,ne(a.fileTypeId)),4===t.code&&(O.value=!0)}return k((()=>{le()})),(e,d)=>{const i=g("el-button"),u=g("JyElMessageBox"),r=l;return v(),j(B,null,[M("div",K,[w(F,{url:"/fileType/page",ref_key:"table",ref:R,method:"POST",hasTree:!0,needAutoRequest:!1,componentsSearchForm:_(ae).componentsSearchForm,componentsTableHeader:_(ae).componentsTable.header,componentsBatch:_(ae).componentsBatch,queryParams:s.value,tableClick:"sealName",onCellClick:re,onCustomClick:pe,onClickBatchButton:ue,onGetResult:d[2]||(d[2]=e=>H.value=e)},{title:b((()=>[M("div",$,[G,M("div",Q,[M("div",W,[w(i,{type:"primary",onClick:d[0]||(d[0]=e=>h.value=!0)},{default:b((()=>[x("+ "+I(e.$t("t-zgj-add")),1)])),_:1})]),X])])])),tree:b((()=>[M("div",Z,[w(_(o),{ref:"tree",modelValue:_(ae).componentsTree.value,"onUpdate:modelValue":d[1]||(d[1]=e=>_(ae).componentsTree.value=e),data:_(ae).componentsTree.data,defaultAttribute:_(ae).componentsTree.defaultAttribute,defaultProps:{children:"child",label:"fileTypeName"},onNodeClick:te},null,8,["modelValue","data","defaultAttribute"])])])),_:1},8,["componentsSearchForm","componentsTableHeader","componentsBatch","queryParams"]),M("div",ee,[w(n,{show:_(ae).componentsDocumentsDetails.show,visible:_(ae).componentsDocumentsDetails.visible,onClickClose:ce},null,8,["show","visible"])]),t.value?(v(),T(_(c),{key:0,show:a.value,"onUpdate:show":de,"onUpdate:searchSelected":ie,searchSelected:A.value,tabsShow:["user","organ","role"]},null,8,["show","searchSelected"])):C("",!0),w(u,{modelValue:_(ae).JyElMessageBox.show,"onUpdate:modelValue":d[3]||(d[3]=e=>_(ae).JyElMessageBox.show=e),show:_(ae).JyElMessageBox.show,defaultAttribute:{},onConfirmClick:oe},{header:b((()=>[x(I(_(ae).JyElMessageBox.header.data),1)])),content:b((()=>[x(I(_(ae).JyElMessageBox.content.data),1)])),_:1},8,["modelValue","show"])]),w(_(q),{modelValue:h.value,"onUpdate:modelValue":d[4]||(d[4]=e=>h.value=e),optionsTree:_(ae).componentsTree.data,onRefresh:le,curFromData:P.value,onOnClosed:se,fileTypePid:s.value.fileTypeIds[0]},null,8,["modelValue","optionsTree","curFromData","fileTypePid"]),w(_(Y),{modelValue:O.value,"onUpdate:modelValue":d[5]||(d[5]=e=>O.value=e),fileTypeId:S.value},null,8,["modelValue","fileTypeId"]),w(_(y),{"onUpdate:modelValue":d[6]||(d[6]=e=>_(ae).showToastDialog.show=!1),show:_(ae).showToastDialog.show,selectionData:_(ae).componentsBatch.selectionData,showToastDialogContent:z.value,label:"formName",onSureAction:oe,curKey:"fileTypeName"},null,8,["show","selectionData","showToastDialogContent"]),w(r,{"onUpdate:modelValue":d[7]||(d[7]=e=>_(ae).showDeleteFTyle.show=!1),show:_(ae).showDeleteFTyle.show,showToastDialogContent:L.value,label:"fileTypeName"},null,8,["show","showToastDialogContent"])],64)}}}),[["__scopeId","data-v-9eb8dd83"]]))}}}))}();
