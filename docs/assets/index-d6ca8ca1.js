import{c as e}from"./tree-bbb5ae5e.js";import{g as a,i as l,H as t,a8 as o,Q as s,_ as d}from"./chunk-vform-6b80d696.js";import{aA as n,ay as i,be as p,k as u,aF as r,as as c,o as m,p as f,x as y,bj as v,a$ as h,F as g,aD as I,m as b,n as w,w as T,aw as k,at as x,bl as M,bb as D,aT as V,v as S,ag as _,al as C,ae as A,aE as B,ac as j,aa as U,z as N,aG as E,a4 as L}from"./chunk-vue-0eb5cee7.js";import{_ as F}from"./ketanchude-51586196.js";import{K as O}from"./KDocumentTypeDialog-a877b983.js";import{u as q,a as z}from"./index-0061e342.js";import R from"./index-300f0340.js";import P from"./index-eb8416f5.js";import J from"./index-c80c012e.js";import{M as $}from"./ModelApi-a04059f9.js";import{ab as H}from"./chunk-ant-design-vue-bd7f8294.js";import{E as Y}from"./chunk-element-plus-b8773542.js";import{a as W}from"./index-64730435.js";import{J as K}from"./JyTable-ee0f04c7.js";import{_ as G}from"./index-7daeab44.js";/* empty css                                                             */import"./chunk-@ant-design-icons-vue-ff9a333c.js";import"./chunk-@ant-design-icons-svg-8f5189a2.js";import"./home-back-8683dc83.js";import"./logo-55df0058.js";import"./request-util-ce71abde.js";import"./sangedian-856844bf.js";import"./Layout-d1d9ddbf.js";import"./searchForm-7d992d01.js";import"./pagination-c0fecb51.js";import"./batch-f5c51482.js";import"./index-ba8b9ad2.js";import"./cha-kong-4b498f35.js";import"./index-f89250d7.js";import"./yuan-hui-61924fee.js";const Q=e=>(k("data-v-b5f496d1"),e=e(),x(),e),X={class:"flowManage-basics-info"},Z={class:"info-box"},ee=Q((()=>f("div",{class:"info-title"}," 请填写如下基础信息 ",-1))),ae={class:"info-from"},le=T(" 物理用印 "),te=T(" 电子签章 "),oe={class:"contbox"},se=Q((()=>f("div",{class:"box-icon"},[f("img",{class:"box-icon-img",src:F,alt:""})],-1))),de={class:"contbox"},ne=Q((()=>f("div",{class:"box-icon"},[f("img",{class:"box-icon-img",src:F,alt:""})],-1))),ie=T(" 变更会清空已设计的流程，请问确定要继续吗？ "),pe=a({props:{businessList:{type:Array,default:()=>[]},modelValue:{type:String,default:""},sealId:{type:String,default:""},sealApplyInitId:{type:String,default:""},openType:{type:String,default:"add"},editBasicsForm:{type:Object,default:()=>({flowName:"",applyTypeId:"",sealUseTypeId:"1",fileTypeIds:[],fileTypeScope:[],showDataScope:[],dataScope:[],readme:""})},modelLinkId:{type:Object,deftault:()=>({})}},emits:"update:modelValue",setup(e,{expose:a,emit:s}){const d=e,T=q(),k=n(!1),x=n(!1),M=n([]),D=n(["user","organ"]),V=n("user"),S=n([]),_=n([]),C=n(null),A=n(!1),B=i({flowName:"",applyTypeId:"",sealUseTypeId:"1",fileTypeIds:[],fileTypeScope:[],showDataScope:[],dataScope:[],readme:""}),j=i({flowName:[{required:!0,message:"请填写流程名称",trigger:"change"}],applyTypeId:[{required:!0,message:"请选择业务类型",trigger:"change"}],sealUseTypeId:[{required:!0,message:"请选择用印类型",trigger:"change"}],fileTypeIds:[{required:!0,message:"请选择文件类型",trigger:["change","blur"]}],showDataScope:[{required:!0,message:"请选择流程适用范围",trigger:["change","blur"]}]}),U=l("accountInfo")&&l("accountInfo").userInfo?l("accountInfo").userInfo.userId:"",N=n({userId:U});p((()=>d.editBasicsForm),(e=>{if(e&&e.flowName&&"edit"===d.openType){B.flowName=e.flowName,B.applyTypeId=e.applyTypeId,B.sealUseTypeId=e.sealUseTypeId,B.readme=e.readme;const a=JSON.parse(JSON.stringify(e.fileTypeScope)),l=JSON.parse(JSON.stringify(e.dataScope));P(l),ue(a),M.value=l,Q.value=a}}));const E=n(null),L=()=>{E.value.blur(),x.value=!0},F=n(null),z=()=>{F.value.blur(),k.value=!0};B.sealUseTypeId=u({get:()=>d.sealId,set(e){s("update:sealId",e)}});const R=e=>{M.value=e,P(e)},P=e=>{const a=[];e&&e.length>0?(B.dataScope=[],_.value=e,e.forEach((e=>{a.push(e.id),B.dataScope.push({scopeId:e.id,scopeName:e.name,includeChild:e.includeChild,scopeType:"user"===e.type?1:2})})),B.showDataScope=a):(B.showDataScope=[],B.dataScope=[])},J=u({get:()=>d.modelLinkId,set(e){s("update:modelLinkId",e)}}),$=n("apply"),H=n(null),Y=()=>{J.value.modelId&&(H.value.blur(),A.value=!0,$.value="apply")},W=()=>{A.value=!1,"apply"===$.value?H.value.toggleMenu():B.sealUseTypeId="1"===B.sealUseTypeId?"2":"1",T.setModelId("",""),J.value={modleId:"",definitionId:""}},K=()=>{A.value=!1,"apply"===$.value&&H.value.blur()},G=e=>{J.value.modelId&&(B.sealUseTypeId=e,A.value=!0,$.value="sealType")};p((()=>B.applyTypeId),(e=>{s("update:modelValue",e)})),p((()=>d.modelValue),(e=>{B.applyTypeId=e}),{deep:!0,immediate:!0});const Q=n([]),pe=e=>{Q.value=e,ue(e)},ue=e=>{const a=[],l=[],t=[];e.forEach((e=>{a.push({fileTypeId:e.id,fileTypeName:e.name,includeChild:e.includeChild?"1":"0",type:"fileType"}),l.push({id:e.id,name:e.name}),t.push(e.id)})),S.value=l,B.fileTypeIds=t,B.fileTypeScope=a},re=e=>{Q.value=me(Q.value,e)},ce=e=>{M.value=me(M.value,e)},me=(e,a)=>Array.isArray(e)&&0!==e.length?e.filter((e=>e.id!==a)):e;return a({getBasicsFormValue:async()=>{const e=await C.value.validate().catch((e=>e));return"boolean"==typeof e&&e?B:[e]},form:B}),(e,a)=>{const l=r("el-input"),s=r("el-form-item"),n=r("el-option"),i=r("el-option-group"),p=r("el-select"),u=r("el-radio"),T=r("el-radio-group"),U=r("el-form"),q=o;return c(),m("div",X,[f("div",Z,[ee,f("div",ae,[y(U,{model:h(B),"label-width":"120px",rules:h(j),ref_key:"ruleFormRef",ref:C},{default:v((()=>[y(s,{label:"流程名称",prop:"flowName"},{default:v((()=>[y(l,{modelValue:h(B).flowName,"onUpdate:modelValue":a[0]||(a[0]=e=>h(B).flowName=e),placeholder:"请输入",clearable:"",maxlength:"45"},null,8,["modelValue"])])),_:1}),y(s,{label:"业务类型",prop:"applyTypeId"},{default:v((()=>[y(p,{modelValue:h(B).applyTypeId,"onUpdate:modelValue":a[1]||(a[1]=e=>h(B).applyTypeId=e),ref_key:"selectApplyRef",ref:H,onClick:Y},{default:v((()=>[(c(!0),m(g,null,I(d.businessList,(e=>(c(),b(i,{key:e.applyTypeName,label:e.applyTypeName},{default:v((()=>[(c(!0),m(g,null,I(e.children,(e=>(c(),b(n,{key:e.applyTypeId,label:e.applyTypeName,value:e.applyTypeId},null,8,["label","value"])))),128))])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),h(B).applyTypeId===d.sealApplyInitId?(c(),b(s,{key:0,label:"用印类型",prop:"sealUseTypeId"},{default:v((()=>[y(T,{modelValue:h(B).sealUseTypeId,"onUpdate:modelValue":a[4]||(a[4]=e=>h(B).sealUseTypeId=e)},{default:v((()=>[y(u,{label:"1",size:"large",onChange:a[2]||(a[2]=e=>G("2"))},{default:v((()=>[le])),_:1}),y(u,{label:"2",size:"large",onChange:a[3]||(a[3]=e=>G("1"))},{default:v((()=>[te])),_:1})])),_:1},8,["modelValue"])])),_:1})):w("",!0),h(B).applyTypeId===d.sealApplyInitId?(c(),b(s,{key:1,label:"文件类型",prop:"fileTypeIds"},{default:v((()=>[f("div",oe,[y(p,{modelValue:h(B).fileTypeIds,"onUpdate:modelValue":a[5]||(a[5]=e=>h(B).fileTypeIds=e),ref_key:"selectRef",ref:E,placeholder:"请选择",multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":4,onClick:L,onRemoveTag:re},{default:v((()=>[(c(!0),m(g,null,I(S.value,(e=>(c(),b(n,{label:e.name,value:e.id,key:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),se])])),_:1})):w("",!0),y(s,{label:"流程适用范围",prop:"showDataScope"},{default:v((()=>[f("div",de,[y(p,{modelValue:h(B).showDataScope,"onUpdate:modelValue":a[6]||(a[6]=e=>h(B).showDataScope=e),ref_key:"selectFileRef",ref:F,placeholder:"请选择",multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":4,onClick:z,onRemoveTag:ce},{default:v((()=>[(c(!0),m(g,null,I(_.value,(e=>(c(),b(n,{label:e.name,value:e.id,key:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),ne])])),_:1}),y(s,{label:"流程说明"},{default:v((()=>[y(l,{modelValue:h(B).readme,"onUpdate:modelValue":a[7]||(a[7]=e=>h(B).readme=e),type:"textarea",maxlength:"100","show-word-limit":"",placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])]),k.value?(c(),b(h(t),{key:0,show:k.value,"onUpdate:show":a[8]||(a[8]=e=>k.value=e),searchSelected:M.value,"onUpdate:searchSelected":R,tabsShow:D.value,activeTab:V.value},null,8,["show","searchSelected","tabsShow","activeTab"])):w("",!0),x.value?(c(),b(h(O),{key:1,show:x.value,"onUpdate:show":a[9]||(a[9]=e=>x.value=e),searchSelected:Q.value,"onUpdate:searchSelected":pe,queryParams:N.value},null,8,["show","searchSelected","queryParams"])):w("",!0),y(q,{modelValue:A.value,"onUpdate:modelValue":a[10]||(a[10]=e=>A.value=e),mode:1,onOnConfirm:W,onOnCancel:K},{default:v((()=>[ie])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-b5f496d1"]]),ue="/zgj-web-fenbao/assets/vector-0f9d5285.svg",re=e=>(k("data-v-7dc9f8f7"),e=e(),x(),e),ce={class:"flowManage-Association-form"},me={class:"choice"},fe={class:"info-box"},ye=S('<div class="info-title" data-v-7dc9f8f7> 选择表单进行关联 </div><div class="info-remind" data-v-7dc9f8f7><div class="info-remind-title" data-v-7dc9f8f7><div class="info-remind-title-icon" data-v-7dc9f8f7><i class="icon" data-v-7dc9f8f7><svg class="iconpark-icon" data-v-7dc9f8f7><use href="#Check-Circle" data-v-7dc9f8f7></use></svg></i></div><div class="info-remind-title-text" data-v-7dc9f8f7> 提示 </div></div><div class="info-remind-p" data-v-7dc9f8f7> 1: 如果关联表单，则该流程仅用于当前表单； </div><div class="info-remind-p" data-v-7dc9f8f7> 2: 若当前业务类型/文件类型换绑新的表单，则新表单无法使用当前流程； </div><div class="info-remind-p" data-v-7dc9f8f7> 3: 如果不关联表单，无论当前业务类型/文件类型绑定的表单怎么变更，该流程都可使用。 </div></div>',2),ve={class:"info-form"},he=T(" 物理用印 "),ge=T(" 电子签章 "),Ie={key:0,class:"info-noContent"},be=[re((()=>f("img",{src:ue},null,-1))),re((()=>f("div",{class:"text"},"去创建",-1)))],we=re((()=>f("div",{class:"info-noContent-desc"},[f("img",{src:"/zgj-web-fenbao/assets/info-6c401016.svg"}),T(" 暂无可关联的表单 ")],-1))),Te={key:1,class:"info-list"},ke={class:"container-list"},xe={class:"list-desc"},Me={style:{"margin-top":"4px"}},De=T(" 选择 "),Ve=[re((()=>f("img",{src:ue},null,-1))),re((()=>f("div",{class:"text"},"去创建",-1)))],Se=re((()=>f("i",null,null,-1))),_e=re((()=>f("i",null,null,-1))),Ce=re((()=>f("i",null,null,-1))),Ae=re((()=>f("i",null,null,-1))),Be=re((()=>f("i",null,null,-1))),je=re((()=>f("i",null,null,-1))),Ue={key:0,class:"exhibition"},Ne={class:"info-footer"},Ee=T("编辑"),Le=T("重新选择"),Fe=T(" 变更会清空已设计的流程，请问确定要继续吗？ "),Oe=a({props:{businessList:{type:Array,default:()=>[]},modelValue:{type:String,default:""},sealId:{type:String,default:"1"},sealApplyInitId:{type:String,default:""},openType:{type:String,default:"add"},formMessageId:{type:String,default:""},modelLinkId:{type:Object,deftault:()=>({})}},emits:"update:modelValue",setup(e,{expose:a,emit:l}){const t=e,d=q(),T=n(null),k=n(""),x=n(null),S=n(!0),_=n(!1),C=n(!1),A=i({currentState:"1",list:{radio:"",data:[]},JyElMessageBox:{show:!1,header:{data:""},content:{data:""}},SealformData:{},SealoptionData:{},showRelatedfFlow:{show:!1,header:{data:"",icon:"/src/assets/svg/common/warning.svg"},content:{data:""}},componentsBatch:{selectionData:[],defaultAttribute:{disabled:!0},data:[{name:"批量删除"}],butDatas:[{name:"知道了",type:"",clickName:function(){}}]}});const B=i({ProcessName:"",ProcessType:!1,sealUseTypeId:"1",applyTypeId:"",formMessageId:"",formDefinitionId:""}),j=u({get:()=>t.modelLinkId,set(e){l("update:modelLinkId",e)}}),U=n("apply"),N=n(null),E=()=>{j.value.modelId&&(N.value.blur(),C.value=!0,U.value="apply")},L=()=>{C.value=!1,"apply"===U.value?N.value.toggleMenu():B.sealUseTypeId="1"===B.sealUseTypeId?"2":"1",d.setModelId("",""),j.value={modleId:"",definitionId:""}},F=()=>{C.value=!1,"apply"===U.value&&N.value.blur()},O=e=>{j.value.modelId&&(B.sealUseTypeId=e,C.value=!0,U.value="sealType")},H=n(""),Y=e=>{H.value=e.formMessageId,S.value=!1,z.getFormJsonById({formMessageId:e.formMessageId}).then((a=>{B.formMessageId=a.data.formMessageId,B.formDefinitionId=a.data.formDefinitionId,A.currentState="2",k.value=a.success&&JSON.parse(a.data.formInfo)||"",x.value=e,S.value=!0}))};p((()=>t.formMessageId),(e=>{e&&Y({formMessageId:e})}));const W=()=>{A.currentState="1"},K=()=>{!async function(e){if(!e)return x.value={formMessageId:null},void(A.JyElMessageBox.show=!0);const a=await s.flowList({formMessageId:e});a.data&&0!==a.data.length?(A.showRelatedfFlow.show=!0,G.value={header:"提示",content:"当前表单被已启用的以下流程所使用，仅当以下流程停用才允许编辑",selectionData:a.data}):(x.value={formMessageId:null},A.JyElMessageBox.show=!0)}(H.value)},G=n(null);const Q=async()=>{try{const e={applyTypeId:B.applyTypeId,sealUseTypeId:B.sealUseTypeId},a=await z.flowSettingForm(e);A.list.data=a.data||[],_.value=!0}catch(e){}};p((()=>B.applyTypeId),(e=>{if(!e)return _.value=!1;A.list.data=[],Q(),l("update:modelValue",e)}),{deep:!0,immediate:!0}),p((()=>t.modelValue),(e=>{B.applyTypeId=e}),{deep:!0,immediate:!0}),B.sealUseTypeId=u({get:()=>t.sealId,set(e){l("update:sealId",e)}}),p((()=>B.sealUseTypeId),(e=>{e&&!j.value.modelId&&Q()}),{deep:!0,immediate:!0});return a({getAssociationValue:()=>B.formDefinitionId?B:[{formDefinitionId:[{message:"请选择关联表单",fieldValue:"",field:"formDefinitionId"}]}],saveAddModel:e=>new Promise(((a,l)=>{if(!B.formDefinitionId)return void l("请选择表单");const t=Math.random();$.add({modelKey:t,formIdList:[B.formDefinitionId],modelName:e}).then((()=>{$.getModelKey({modelKey:t}).then((e=>{a({modelId:e.modelId,definitionId:e.definitionId})}))}))}))}),(e,a)=>{const l=r("el-option"),s=r("el-option-group"),d=r("el-select"),n=r("el-form-item"),i=r("el-radio"),p=r("el-radio-group"),u=r("el-form"),j=r("el-button"),U=r("el-scrollbar"),q=P,z=r("JyElMessageBox"),$=R,H=o;return c(),m("div",ce,[M(f("div",me,[f("div",fe,[ye,f("div",ve,[y(u,{model:h(B),"label-width":"80px","status-icon":"",style:{width:"500px"}},{default:v((()=>[y(n,{label:"业务类型",prop:"applyTypeId",required:""},{default:v((()=>[y(d,{modelValue:h(B).applyTypeId,"onUpdate:modelValue":a[0]||(a[0]=e=>h(B).applyTypeId=e),ref_key:"selectApplyRef",ref:N,onClick:E},{default:v((()=>[(c(!0),m(g,null,I(t.businessList,(e=>(c(),b(s,{key:e.applyTypeName,label:e.applyTypeName},{default:v((()=>[(c(!0),m(g,null,I(e.children,(e=>(c(),b(l,{key:e.applyTypeId,label:e.applyTypeName,value:e.applyTypeId},null,8,["label","value"])))),128))])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),h(B).applyTypeId===t.sealApplyInitId?(c(),b(n,{key:0,label:"用印类型",prop:"sealUseTypeId"},{default:v((()=>[y(p,{modelValue:h(B).sealUseTypeId,"onUpdate:modelValue":a[3]||(a[3]=e=>h(B).sealUseTypeId=e)},{default:v((()=>[y(i,{label:"1",size:"large",onChange:a[1]||(a[1]=e=>O("2"))},{default:v((()=>[he])),_:1}),y(i,{label:"2",size:"large",onChange:a[2]||(a[2]=e=>O("1"))},{default:v((()=>[ge])),_:1})])),_:1},8,["modelValue"])])),_:1})):w("",!0)])),_:1},8,["model"])]),0===h(A).list.data.length&&_.value?(c(),m("div",Ie,[f("div",{class:"info-noContent-backcolor",onClick:K},be),we])):w("",!0),h(B).applyTypeId&&0!==h(A).list.data.length?(c(),m("div",Te,[y(U,{style:{height:"100%"},"view-style":"padding: 0 54px"},{default:v((()=>[f("div",ke,[(c(!0),m(g,null,I(h(A).list.data,((e,a)=>(c(),m("div",{class:"list",key:a},[f("div",xe,V(e.formName),1),f("div",Me,[y(j,{type:"primary",class:"btn",onClick:a=>Y(e)},{default:v((()=>[De])),_:2},1032,["onClick"])])])))),128)),f("div",{class:"info-noContent-backcolor",onClick:K},Ve),Se,_e,Ce,Ae,Be,je])])),_:1})])):w("",!0)])],512),[[D,"1"===h(A).currentState]]),"2"===h(A).currentState?(c(),m("div",Ue,[y(U,{class:"info-box",always:""},{default:v((()=>[S.value?(c(),b(q,{key:0,mode:"render",formJson:k.value,formData:h(A).SealformData,optionData:h(A).SealoptionData,ref_key:"refFillFormInformation",ref:T,onOnLoaded:a[4]||(a[4]=e=>T.value.disableForm())},null,8,["formJson","formData","optionData"])):w("",!0)])),_:1}),f("div",Ne,[y(j,{type:"primary",onClick:K},{default:v((()=>[Ee])),_:1}),y(j,{onClick:W},{default:v((()=>[Le])),_:1})])])):w("",!0),f("div",null,[y(z,{modelValue:h(A).JyElMessageBox.show,"onUpdate:modelValue":a[7]||(a[7]=e=>h(A).JyElMessageBox.show=e),"custom-content":!0,defaultAttribute:{fullscreen:!0,height:"100%"}},{default:v((()=>[h(A).JyElMessageBox.show?(c(),b(J,{key:0,modelValue:h(A).JyElMessageBox.show,"onUpdate:modelValue":a[5]||(a[5]=e=>h(A).JyElMessageBox.show=e),addTitle:"编辑",columnData:x.value,onClose:a[6]||(a[6]=e=>h(A).JyElMessageBox.show=!1),sealUseTypeId:h(B).sealUseTypeId,applyTypeId:h(B).applyTypeId,optionData:t.businessList,onReloadData:Y},null,8,["modelValue","columnData","sealUseTypeId","applyTypeId","optionData"])):w("",!0)])),_:1},8,["modelValue"])]),y($,{"onUpdate:modelValue":a[8]||(a[8]=e=>h(A).showRelatedfFlow.show=!1),show:h(A).showRelatedfFlow.show,selectionData:h(A).componentsBatch.selectionData,showToastDialogContent:G.value,label:"flowName"},null,8,["show","selectionData","showToastDialogContent"]),y(H,{modelValue:C.value,"onUpdate:modelValue":a[9]||(a[9]=e=>C.value=e),mode:1,onOnConfirm:L,onOnCancel:F},{default:v((()=>[Fe])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-7dc9f8f7"]]),qe=e=>(k("data-v-4d3f2f55"),e=e(),x(),e),ze={class:"flowManage-advanced-setup"},Re={class:"info-box"},Pe={class:"time"},Je={class:"time-eminder"},$e=S('<div class="time-eminder-label" data-v-4d3f2f55><span class="time-eminder-label-text" data-v-4d3f2f55> 超时提醒 </span><i class="icon" data-v-4d3f2f55><svg class="iconpark-icon" data-v-4d3f2f55><use href="#Vector1" data-v-4d3f2f55></use></svg></i></div>',1),He={class:"time-eminder-switch"},Ye={class:"time-Number"},We=qe((()=>f("span",{class:"time-Number-text"},"超时",-1))),Ke={class:"time-Number-input"},Ge=qe((()=>f("span",{class:"time-Number-text"},"小时",-1))),Qe={class:"deWeight"},Xe=qe((()=>f("span",{class:"deWeight-text"},"审批人自动去重",-1))),Ze={class:"deWeight-radio"},ea=T("不去重"),aa=T("出现多次时，仅保留第一次"),la=T("在连续出现时，仅保留第一次"),ta=a({setup(e){const a=i({isTimeoutRemind:1,remindDuration:24,autoDistinct:0});return(e,l)=>{const t=r("el-switch"),o=r("el-input-number"),s=r("el-radio"),d=r("el-radio-group");return c(),m("div",ze,[f("div",Re,[f("div",Pe,[f("div",Je,[$e,f("div",He,[y(t,{modelValue:h(a).isTimeoutRemind,"onUpdate:modelValue":l[0]||(l[0]=e=>h(a).isTimeoutRemind=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])]),f("div",Ye,[We,f("div",Ke,[y(o,{modelValue:h(a).remindDuration,"onUpdate:modelValue":l[1]||(l[1]=e=>h(a).remindDuration=e),min:0},null,8,["modelValue"])]),Ge])]),f("div",Qe,[Xe,f("div",Ze,[y(d,{modelValue:h(a).autoDistinct,"onUpdate:modelValue":l[2]||(l[2]=e=>h(a).autoDistinct=e)},{default:v((()=>[y(s,{label:0},{default:v((()=>[ea])),_:1}),y(s,{label:1},{default:v((()=>[aa])),_:1}),y(s,{label:2},{default:v((()=>[la])),_:1})])),_:1},8,["modelValue"])])])])])}}},[["__scopeId","data-v-4d3f2f55"]]),oa=e=>(k("data-v-a7c7c40d"),e=e(),x(),e),sa={class:"components-ElMessageBox"},da={key:0,class:"dialog-header"},na={key:0,class:"dialog-header-icon"},ia=[oa((()=>f("svg",{class:"iconpark-icon"},[f("use",{href:"#icon4"})],-1)))],pa={key:1,class:"dialog-header-cont"},ua=[oa((()=>f("svg",{class:"iconpark-icon"},[f("use",{href:"#Vector"})],-1)))],ra={key:1,class:"cut-off-rule"},ca={key:2,class:"cut-off-rule"},ma=T("确定"),fa=T("取消"),ya=a({props:{type:{type:String,default:"0"},modelValue:{type:Boolean,default:!0},"show-cut-off-rule":{type:Boolean,default:!1},"show-close":{type:Boolean,default:!0},"show-icon":{type:Boolean,default:!1},"show-title":{type:Boolean,default:!0},"show-footer":{type:Boolean,default:!0},"show-header":{type:Boolean,default:!0},"custom-content":{type:Boolean,default:!1},defaultAttribute:{type:Object,default:()=>({})}},emits:["close","update:modelValue"],setup(e,{emit:a}){const l=e,t=i({props:{defaultAttribute:{"align-center":!0,"show-close":!1,width:"500px",center:!1}}});function o(){const e=t.props;for(const a in l)Object.hasOwnProperty.call(e,a)?"defaultAttribute"!==a&&(e[a]=l[a]):e[a]=l[a];for(const a in l.defaultAttribute)Object.hasOwnProperty.call(l.defaultAttribute,a)&&(e.defaultAttribute[a]=l.defaultAttribute[a])}function s(){t.props.modelValue=!1}function d(){t.props.modelValue=!1,a("update:modelValue",t.props.modelValue)}return p(l,((e,a)=>{o()})),_((()=>{o()})),C((()=>{})),(e,a)=>{const l=r("el-button"),o=H;return c(),m("div",sa,[y(o,U({visible:h(t).props.modelValue,"onUpdate:visible":a[0]||(a[0]=e=>h(t).props.modelValue=e)},h(t).props.defaultAttribute,{footer:null,keyboard:!1,width:"100%","wrap-class-name":"full-modal",getContainer:!1,closable:!1,zIndex:1003,onOnCancel:d,onOnOk:d}),{default:v((()=>[h(t).props.customContent?(c(),m("div",{key:0,class:"dialog",style:A({height:h(t).props.defaultAttribute.height})},[B(e.$slots,"default",{},void 0,!0)],4)):(c(),m("div",{key:1,class:"dialog",style:A({height:h(t).props.defaultAttribute.height})},[h(t).props.showHeader&&(h(t).props.showIcon||h(t).props.showTitle||h(t).props.showCutOffRule)?(c(),m("div",da,[h(t).props.showIcon?(c(),m("div",na,ia)):w("",!0),h(t).props.showTitle?(c(),m("div",pa,[B(e.$slots,"header",{},void 0,!0)])):w("",!0),h(t).props.showClose?(c(),m("div",{key:2,class:"dialog-header-remove",onClick:s},ua)):w("",!0)])):w("",!0),h(t).props.showCutOffRule?(c(),m("div",ra)):w("",!0),f("div",{class:j(["dialog-content",{"center-content":!!h(t).props.defaultAttribute.center}])},[B(e.$slots,"content",{},void 0,!0)],2),h(t).props.showCutOffRule?(c(),m("div",ca)):w("",!0),h(t).props.showFooter?(c(),m("div",{key:3,class:j(["dialog-footer",{"center-footer":!!h(t).props.defaultAttribute.center}])},[B(e.$slots,"footer",{},(()=>[y(l,{type:"primary"},{default:v((()=>[ma])),_:1}),y(l,{onClick:s},{default:v((()=>[fa])),_:1})]),!0)],2)):w("",!0)],4))])),_:3},16,["visible"])])}}},[["__scopeId","data-v-a7c7c40d"]]),va=e=>(k("data-v-385067d7"),e=e(),x(),e),ha={class:"add-flow-modal"},ga={class:"flowManage-layout"},Ia={class:"process"},ba={class:"header"},wa={class:"process-back"},Ta=[va((()=>f("svg",{class:"iconpark-icon"},[f("use",{href:"#Vector8Stroke"})],-1)))],ka={class:"process-back-text"},xa={class:"process-tabs"},Ma=["onClick"],Da={class:"tabs-icon"},Va={class:"tabs-text"},Sa={class:"process-save"},_a={class:"process-save-down"},Ca={class:"process-save-down-text"},Aa={class:"popover-cont"},Ba=va((()=>f("div",{class:"popover-cont-title"}," 内容不完善，当前无法发布 ",-1))),ja=va((()=>f("div",{class:"popover-cont-subTitle"}," 以下内容不完善，请修改后发布 ",-1))),Ua={key:0,class:"popover-cont-list"},Na={class:"popover-cont-list-li-name"},Ea={class:"popover-cont-list-li-desc"},La=va((()=>f("div",{class:"popover-cont-list-li-but"},"去修改 ",-1))),Fa={class:"content"},Oa=T(" 确定 "),qa=a({props:{modelValue:{type:Boolean,default:!1},businessList:{type:Array,default:()=>[]},openType:{type:String,default:"add"},treeSelectedId:{type:String,default:""},sealApplyInitId:{type:String,default:""},editModleIds:{type:Object,default:()=>({definitionId:"",modelId:"",flowMessageId:""})}},emits:"update:modelValue",setup(e,{emit:a}){const l=e,t=q(),o=n("1"),k=N({loader:()=>d((()=>import("./index-07f15126.js")),["assets/index-07f15126.js","assets/index-0061e342.js","assets/chunk-vue-0eb5cee7.js","assets/chunk-vform-6b80d696.js","assets/chunk-element-plus-b8773542.js","assets/chunk-ant-design-vue-bd7f8294.js","assets/chunk-@ant-design-icons-svg-8f5189a2.js","assets/chunk-ant-design-vue-106ae610.css","assets/chunk-element-plus-27fc09b8.css","assets/chunk-@ant-design-icons-vue-ff9a333c.js","assets/chunk-vform-f011519b.css","assets/home-back-8683dc83.js","assets/logo-55df0058.js","assets/request-util-ce71abde.js","assets/index-17174844.css","assets/ModelApi-a04059f9.js","assets/index-db21537e.css"])}),x=i({checkedIndex:"1",tabsData:[{index:"1",label:"基础信息",checked:!0},{index:"2",label:"关联表单"},{index:"3",label:"流程设计"},{index:"4",label:"高级设置"}],jyBoxHeader:"",jyBoxCont:"",jyBoxShow:!1}),S=u({get:()=>l.modelValue,set(e){a("update:modelValue",e)}}),_=u({get:()=>l.treeSelectedId,set(e){a("update:treeSelectedId",e)}}),C=()=>{S.value=!1,a("reloadData")},A=n(null),B=n(null),U=n(null),F=n(null),O=n([]),R=n({modelId:"",definitionId:""}),P=n(!0),J=n(!1),H=n({applyTypeId:"",fileTypeScope:[],dataScope:[],flowName:"",readme:"",sealUseTypeId:""}),W=n("");"edit"===l.openType&&(R.value.definitionId=l.editModleIds.definitionId,R.value.modelId=l.editModleIds.modelId,t.setModelId(R.value.modelId,R.value.definitionId),z.flowDetail({flowMessageId:l.editModleIds.flowMessageId}).then((e=>{const a=e.data.organScope?e.data.organScope:[],l=e.data.organUserScope?e.data.organUserScope:[];H.value={applyTypeId:e.data.applyTypeId,fileTypeScope:e.data.fileTypeScope,dataScope:a.concat(l),flowName:e.data.flowName,readme:e.data.readme,sealUseTypeId:e.data.sealUseTypeId},W.value=e.data.formMessageId})));const K=e=>{x.tabsData.forEach((a=>{a.checked=!1,a.index===e.index&&(a.checked=!0,x.checkedIndex=a.index)}))},G=async()=>{O.value=[];const e=await U.value.getBasicsFormValue();if(Array.isArray(e))for(const a in e[0])O.value.push({type:"基础信息",message:e[0][a][0].message});const t=B.value.getAssociationValue();if(Array.isArray(t))for(const a in t[0])O.value.push({type:"关联表单",message:t[0][a][0].message});let o=[];if(A.value){if(o=await A.value.designSave("add"===l.openType?"designModel":"updateModel"),Array.isArray(o))for(const a in o[0])O.value.push({type:"流程设计",message:o[0][a][0].message})}else O.value.push({type:"流程设计",message:"请设计流程"});if(O.value.length>0)return;const s={...e,...t,...o};"add"===l.openType?z.add(s).then((()=>{C(),a("reloadData")})):"edit"===l.openType&&$.detail({modelId:l.editModleIds.modelId}).then((e=>{z.flowEdit({...s,flowMessageId:l.editModleIds.flowMessageId,modelId:l.editModleIds.modelId,definitionId:e.definitionId}).then((()=>{C(),a("reloadData")}))}))};return p((()=>R.value),(e=>{if(e){if(!e||!e.modelId)return;t.setModelId(e.modelId,e.definitionId)}})),(a,t)=>{const d=r("el-popover"),n=r("el-button"),i=r("JyElMessageBox"),p=E("loading");return c(),m("div",ha,[y(ya,{modelValue:h(S),"onUpdate:modelValue":t[6]||(t[6]=e=>L(S)?S.value=e:null),"custom-content":!0,defaultAttribute:{fullscreen:!0,height:"100%"}},{default:v((()=>[f("div",ga,[f("div",Ia,[f("div",ba,[f("div",wa,[f("i",{class:"iconpark",onClick:C},Ta),f("span",ka,[M(f("span",null,V(a.$t("t-zgj-sync.add")),513),[[D,"add"===l.openType]]),M(f("span",null,V(a.$t("t-editors")),513),[[D,"edit"===l.openType]])])]),f("div",xa,[(c(!0),m(g,null,I(h(x).tabsData,((e,a)=>(c(),m("div",{class:j(["tabs",{"checked-tabs":!!e.checked}]),key:a,onClick:a=>(async e=>{if("3"===e.index){if("edit"===l.openType&&R.value.modelId)return J.value=!0,K(e),P.value?void s.flowDetail({...l.editModleIds,edit:!0}).then((e=>{J.value=!1,P.value=!1,A.value.handleSetData(e.data.data)})):void(J.value=!1);O.value=[];const a=await U.value.getBasicsFormValue();if(Array.isArray(a)){for(const e in a[0])O.value.push({type:"基础信息",message:a[0][e][0].message});Y.warning("请填写基础信息")}const t=B.value.getAssociationValue();if(Array.isArray(t)){for(const e in t[0])O.value.push({type:"关联表单",message:t[0][e][0].message});Y.warning("请选择关联表单")}if(O.value.length>0)return;R.value=await B.value.saveAddModel(U.value.form.flowName).catch((e=>{x.jyBoxHeader="提示？",x.jyBoxCont=e,x.jyBoxShow=!0})),R.value||(x.jyBoxHeader="提示？",x.jyBoxCont="请填写完整信息",x.jyBoxShow=!0)}K(e)})(e)},[f("div",Da,V(e.index),1),f("div",Va,V(e.label),1)],10,Ma)))),128))]),f("div",Sa,[f("div",_a,[y(d,{placement:"bottom",width:400,trigger:"click"},{reference:v((()=>[f("div",Ca,[M(f("span",null,V(O.value.length)+"项不完善 ",513),[[D,0!==O.value.length]])])])),default:v((()=>[f("div",Aa,[Ba,ja,O.value?(c(),m("div",Ua,[(c(!0),m(g,null,I(O.value,((e,a)=>(c(),m("div",{class:"popover-cont-list-li",key:a},[f("div",Na,V(e.type),1),f("div",Ea,V(e.message),1),La])))),128))])):w("",!0)])])),_:1})]),y(n,{class:"process-save-but",type:"primary",onClick:G},{default:v((()=>[T(V(a.$t("t-zgj-Save")),1)])),_:1})])]),f("div",Fa,[M(y(pe,{ref_key:"refBasicsInfo",ref:U,modelValue:h(_),"onUpdate:modelValue":t[0]||(t[0]=e=>L(_)?_.value=e:null),sealId:o.value,"onUpdate:sealId":t[1]||(t[1]=e=>o.value=e),modelLinkId:R.value,"onUpdate:modelLinkId":t[2]||(t[2]=e=>R.value=e),businessList:l.businessList,sealApplyInitId:l.sealApplyInitId,openType:e.openType,editBasicsForm:H.value},null,8,["modelValue","sealId","modelLinkId","businessList","sealApplyInitId","openType","editBasicsForm"]),[[D,"1"==h(x).checkedIndex]]),M(y(Oe,{ref_key:"refAssociationForm",ref:B,modelValue:h(_),"onUpdate:modelValue":t[3]||(t[3]=e=>L(_)?_.value=e:null),sealId:o.value,"onUpdate:sealId":t[4]||(t[4]=e=>o.value=e),modelLinkId:R.value,"onUpdate:modelLinkId":t[5]||(t[5]=e=>R.value=e),businessList:l.businessList,sealApplyInitId:l.sealApplyInitId,openType:e.openType,formMessageId:W.value},null,8,["modelValue","sealId","modelLinkId","businessList","sealApplyInitId","openType","formMessageId"]),[[D,"2"==h(x).checkedIndex]]),R.value.modelId?M((c(),b(h(k),{key:0,ref_key:"refVFlowDesign",ref:A,initObj:R.value,openType:e.openType,style:{height:"calc(100vh - 100px)"}},null,8,["initObj","openType"])),[[D,"3"==h(x).checkedIndex],[p,J.value]]):w("",!0),M(y(ta,{ref_key:"refAdvancedSetup",ref:F},null,512),[[D,"4"==h(x).checkedIndex]])])])])])),_:1},8,["modelValue"]),y(i,{modelValue:h(x).jyBoxShow,"onUpdate:modelValue":t[8]||(t[8]=e=>h(x).jyBoxShow=e),show:h(x).jyBoxShow,defaultAttribute:{},onOnCancel:t[9]||(t[9]=e=>h(x).jyBoxShow=!1)},{header:v((()=>[T(V(h(x).jyBoxHeader),1)])),content:v((()=>[T(V(h(x).jyBoxCont),1)])),footer:v((()=>[y(n,{type:"primary",onClick:t[7]||(t[7]=e=>h(x).jyBoxShow=!1)},{default:v((()=>[Oa])),_:1})])),_:1},8,["modelValue","show"])])}}},[["__scopeId","data-v-385067d7"]]),za=[{prop:"flowName",label:"流程名称",fixed:"left",sortable:!0,flex:!0,"min-width":150,show:!0},{prop:"applyTypeName",label:"业务类型",sortable:!0,"min-width":150,show:!0},{prop:"fileTypeName",label:"文件类型",sortable:!0,"min-width":150,show:!0},{prop:"flag",label:"状态",sortable:!0,"min-width":120,show:!0},{prop:"createUserName",label:"创建人",sortable:!0,"min-width":120,show:!0},{prop:"modifyDatetime",label:"更新时间",sortable:!0,"min-width":180,show:!0},{prop:"caozuo",label:"操作",fixed:"right","min-width":280,align:"center",show:!0,rankDisplayData:[{name:"t-zgj-Edit"},{name:"t-zgj-Delete"},{name:"status"},{name:"t-zgj-qyWechat.Copy"}]}],Ra=[{prop:"flowName",label:"流程名称",sortable:!0,flex:!0,"min-width":150,show:!0},{prop:"applyTypeName",label:"业务类型",sortable:!0,"min-width":150,show:!0},{prop:"flag",label:"状态",sortable:!0,"min-width":120,show:!0},{prop:"createUserName",label:"创建人",sortable:!0,"min-width":120,show:!0},{prop:"modifyDatetime",label:"更新时间",sortable:!0,"min-width":180,show:!0},{prop:"caozuo",label:"操作",fixed:"right","min-width":260,show:!0,align:"center",rankDisplayData:[{name:"t-zgj-Edit"},{name:"t-zgj-Delete"},{name:"status"},{name:"t-zgj-qyWechat.Copy"}]}],Pa={class:"flowManage-index"},Ja={class:"title"},$a={class:"title-more"},Ha={class:"title-more-add"},Ya=(e=>(k("data-v-38977b56"),e=e(),x(),e))((()=>f("div",{class:"title-more-down"},null,-1))),Wa={class:"header-div"},Ka=["src"],Ga={class:"content-div"},Qa=T(" 确认 "),Xa=T("取消"),Za={class:"header-div"},el=["src"],al={class:"content-div"},ll=a({setup(a){const l=n(!1),t=n([]),o=n({modelId:"",definitionId:""}),s=n(!1),d=n(null),p=n(null),u=n({flowMessageId:"",modelId:"",definitionId:""}),k=()=>{s.value=!0,d.value="add"},x=n(null),M=n({}),D=n(""),S=[{id:"keyword",label:"关键词",type:"input",inCommonUse:!0,defaultAttribute:{placeholder:"表单名称/创建人"}},{id:"status",label:"状态",type:"select",optionLabel:"label",optionValue:"value",inCommonUse:!0,defaultAttribute:{placeholder:"请选择"},options:[{value:"1",label:"启用"},{value:"0",label:"停用"}]},{id:"updateTime",label:"更新时间",type:"picker",requestType:"array",startRequest:"updateStartTime",endRequest:"updateEndTime",inCommonUse:!1,defaultAttribute:{type:"daterange","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD","disabled-date":e=>e.getTime()>Date.now(),"default-value":[new Date((new Date).setMonth((new Date).getMonth()-1)),new Date]},style:{}},{id:"fileTypeId",requestParams:"fileTypeId",label:"文件类型",type:"derivable",inCommonUse:!1,defaultAttribute:{placeholder:"请选择",type:"fileType",multiple:!1,joinStr:","},options:[]},{id:"sealUseTypeId",label:"用印类型",type:"select",optionLabel:"label",optionValue:"value",inCommonUse:!1,defaultAttribute:{placeholder:"请选择"},options:[{value:"1",label:"物理用印"},{value:"2",label:"电子签章"}]},{id:"formMessageId",label:"关联表单",type:"select",optionLabel:"formName",optionValue:"formMessageId",filterable:!0,inCommonUse:!1,defaultAttribute:{placeholder:"请选择"},requestObj:{method:"GET",url:"/form/list",type:"flow"}}],C=[{id:"keyword",label:"关键词",type:"input",inCommonUse:!0,defaultAttribute:{placeholder:"表单名称/创建人"}},{id:"status",label:"状态",type:"select",optionLabel:"label",optionValue:"value",inCommonUse:!0,defaultAttribute:{placeholder:"请选择"},options:[{value:"1",label:"启用"},{value:"0",label:"停用"}]},{id:"updateTime",label:"更新时间",type:"picker",requestType:"array",startRequest:"updateStartTime",endRequest:"updateEndTime",inCommonUse:!1,defaultAttribute:{type:"daterange","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD","disabled-date":e=>e.getTime()>Date.now(),"default-value":[new Date((new Date).setMonth((new Date).getMonth()-1)),new Date]},style:{}},{id:"formMessageId",label:"关联表单",type:"select",optionLabel:"formName",optionValue:"formMessageId",filterable:!0,inCommonUse:!1,defaultAttribute:{placeholder:"请选择"},requestObj:{method:"GET",url:"/form/list",type:"flow"}}],A=i({flowMessageId:"",columnData:{},batchColumnData:[],MessageBox:{show:!1,header:{data:"",icon:"/src/assets/svg/common/warning.svg"},content:{data:""},type:"删除"},showToastDialog:{show:!1,header:{data:"",icon:"/src/assets/svg/common/warning.svg"},content:{data:""},type:"删除"},componentsSearchForm:{style:{lineStyle:{width:"30%"},labelStyle:{width:"100px"}},data:S,butData:[{id:"more",name:"展开",type:"unfold",defaultAttribute:{type:"primary"},style:{}},{id:"inquire",name:"查询",type:"click",defaultAttribute:{type:"primary"},style:{}},{id:"reset",name:"重置",type:"click",defaultAttribute:{},style:{}}]},componentsTable:{header:za,data:[],defaultAttribute:{stripe:!0,"header-cell-style":{background:"var(--jy-color-fill--3)"},"cell-style":({row:e,column:a,rowIndex:l,columnIndex:t})=>{if("flowName"===a.property)return{color:"var(--jy-info-6)",cursor:"pointer"}}}},componentsPagination:{data:{amount:0,index:1,pageNumber:10},defaultAttribute:{layout:"prev, pager, next, jumper",total:0,"page-sizes":[10,100,200,300,400],background:!0}},componentsTree:{data:[],defaultAttribute:{"check-on-click-node":!0,"show-checkbox":!1,"default-expand-all":!0,"expand-on-click-node":!1,"check-strictly":!0,"highlight-current":!0,"node-key":"applyTypeId","current-node-key":"2"},defaultProps:{label:"applyTypeName",children:"children"},value:""},componentsBatch:{selectionData:[],defaultAttribute:{disabled:!0},data:[{name:"批量删除"},{name:"批量启用"},{name:"批量停用"}],butDatas:[{name:"知道了",type:"",clickName:U}]}}),B=(e,a,s,d)=>{"flowName"===a.property&&(l.value=!0,o.value={modelId:e.modelId,definitionId:e.definitionId},t.value=[{value:"detail",params:{flowMessageId:e.flowMessageId}},{value:"record",params:{operationId:e.flowMessageId}},{value:"version",params:{flowMessageId:e.flowMessageId}}])},j=(e,a,l,t)=>{A.columnData=a,A.flowMessageId=a.flowMessageId,A.title=l.name,"t-zgj-qyWechat.Copy"===l.name&&Y.warning("功能暂未实现，敬请期待"),"t-zgj-Edit"===l.name&&("1"===a.flag?Y.warning("请将流程停用后再进行修改"):(s.value=!0,d.value="edit",u.value.flowMessageId=a.flowMessageId,u.value.definitionId=a.definitionId,u.value.modelId=a.modelId)),"t-zgj-Delete"===l.name&&(A.MessageBox.header.data="提示",A.MessageBox.content.data="确认要删除流程吗？",A.MessageBox.show=!0,A.MessageBox.type="删除"),"status"===l.name&&"1"===a.flag&&(A.MessageBox.header.data="停用",A.MessageBox.content.data="请问确定停用该流程吗？",A.MessageBox.show=!0,A.MessageBox.type="停用"),"status"===l.name&&"0"===a.flag&&(A.MessageBox.header.data="启用",A.MessageBox.content.data="请问确定启用该流程吗？",A.MessageBox.show=!0,A.MessageBox.type="启用")};function U(){A.showToastDialog.show=!1}const N=(e,a)=>{a.then((a=>{200===a.code?Y.success(`${e}成功！`):Y.success(`${e}失败，请重试`),A.MessageBox.show=!1,q()}))};function E(e,a){A.batchColumnData=[],a.forEach((e=>{A.batchColumnData.push(e.flowName)})),A.showToastDialog.header.data=e.name,A.showToastDialog.content.data=`已选中以下流程，请问确定要${e.name}吗？`,A.showToastDialog.show=!0,A.showToastDialog.type=e.name,A.componentsBatch.butDatas=[{name:"确定",type:"primary",clickName:()=>L(a)},{name:"取消",type:"",clickName:U}]}const L=e=>{const a=e,l=[];switch(A.showToastDialog.type){case"批量删除":A.batchColumnData=[],a.forEach((e=>{"1"===e.flag&&A.batchColumnData.push(e.flowName),l.push(e.flowMessageId)})),A.batchColumnData.length>0?(A.showToastDialog.header.data=A.showToastDialog.type,A.showToastDialog.content.data="请将以下流程停用后再进行删除",A.componentsBatch.butDatas=[{name:"知道了",type:"primary",clickName:U}]):F("批量删除",z.batchDelete({flowMessageIds:l}));break;case"批量停用":a.forEach((e=>{l.push(e.flowMessageId)})),F("批量停用",z.batachEnable({flowMessageIds:l,flag:"0"}));break;case"批量启用":a.forEach((e=>{l.push(e.flowMessageId)})),F("批量启用",z.batachEnable({flowMessageIds:l,flag:"1"}))}},F=(e,a)=>{a.then((a=>{200===a.code?Y.success(`${e}成功！`):Y.error(`${e}失败，请重试！`),A.showToastDialog.show=!1,q()}))},O=(e,a)=>{1!==a.level&&(M.value.applyTypeId=e.applyTypeId?e.applyTypeId:null,A.componentsTree.value=e.applyTypeId,R(e.applyTypeId))},q=()=>{R(A.componentsTree.value),x.value.reloadData()},R=e=>{e===D.value?(A.componentsSearchForm.data=S,A.componentsTable.header=za,x.value.reloadSearchForm(S,{applyTypeId:e}),x.value.setTableHeader(za)):(A.componentsSearchForm.data=C,A.componentsTable.header=Ra,x.value.setTableHeader(Ra),x.value.reloadSearchForm(C,{applyTypeId:e})),x.value.reloadData()};return _((()=>{W.listApplyTypeTree({}).then((e=>{const a=[];e.data.forEach((e=>{if(e.applyTypePid){"用印申请"===e.applyTypeName&&(D.value=e.applyTypeId);const l=a.findIndex((a=>a.applyTypeId===e.applyTypePid));l>-1&&a[l].children.push(e)}else e.children=[],a.push(e)})),A.componentsTree.data=a,A.componentsTree.value=a[0].children[0].applyTypeId,M.value.applyTypeId=D.value,q()}))})),(a,n)=>{const i=r("el-button"),S=r("JyElMessageBox"),_=r("el-scrollbar");return c(),m("div",Pa,[y(K,{url:"/flow/page",ref_key:"table",ref:x,hasTree:!0,needAutoRequest:!1,componentsSearchForm:h(A).componentsSearchForm,componentsTableHeader:h(A).componentsTable.header,componentsBatch:h(A).componentsBatch,queryParams:M.value,statusColoum:"flag",tableClick:"flowName",openValue:"1",isNo:!1,onCellClick:B,onCustomClick:j,onClickBatchButton:E},{title:v((()=>[f("div",Ja,[f("div",null,V(a.$t("t-zgj-cg-menu-liucheng-guanli")),1),f("div",$a,[f("div",Ha,[y(i,{type:"primary",onClick:k},{default:v((()=>[T(" + "+V(a.$t("t-zgj-sync.add")),1)])),_:1})]),Ya])])])),tree:v((()=>[f("div",null,[h(A).componentsTree.value?(c(),b(h(e),{key:0,ref_key:"tree",ref:p,modelValue:h(A).componentsTree.value,"onUpdate:modelValue":n[0]||(n[0]=e=>h(A).componentsTree.value=e),data:h(A).componentsTree.data,defaultAttribute:h(A).componentsTree.defaultAttribute,defaultProps:h(A).componentsTree.defaultProps,onCurrentChange:O},null,8,["modelValue","data","defaultAttribute","defaultProps"])):w("",!0)])])),_:1},8,["componentsSearchForm","componentsTableHeader","componentsBatch","queryParams"]),y(G,{modelValue:l.value,"onUpdate:modelValue":n[1]||(n[1]=e=>l.value=e),modulesName:"system_flow_management",detailParams:t.value,importParams:o.value},null,8,["modelValue","detailParams","importParams"]),s.value?(c(),b(qa,{key:0,modelValue:s.value,"onUpdate:modelValue":n[2]||(n[2]=e=>s.value=e),openType:d.value,sealApplyInitId:D.value,editModleIds:u.value,treeSelectedId:h(A).componentsTree.value,"onUpdate:treeSelectedId":n[3]||(n[3]=e=>h(A).componentsTree.value=e),businessList:h(A).componentsTree.data,onReloadData:q},null,8,["modelValue","openType","sealApplyInitId","editModleIds","treeSelectedId","businessList"])):w("",!0),y(S,{modelValue:h(A).MessageBox.show,"onUpdate:modelValue":n[6]||(n[6]=e=>h(A).MessageBox.show=e),show:h(A).MessageBox.show,defaultAttribute:{}},{header:v((()=>[f("div",Wa,[f("img",{src:h(A).MessageBox.header.icon,alt:""},null,8,Ka),f("span",null,V(h(A).MessageBox.header.data),1)])])),content:v((()=>[f("div",Ga,V(h(A).MessageBox.content.data),1)])),footer:v((()=>[y(i,{type:"primary",onClick:n[4]||(n[4]=e=>(e=>{if("取消"===e&&(A.MessageBox.show=!1),"删除"===e){if("1"===A.columnData.flag)return A.MessageBox.show=!1,void Y.warning("请将流程停用后再进行删除");N(e,z.flowDelete({flowMessageId:A.flowMessageId}))}"停用"===e&&N(e,z.flowEnable({flowMessageId:A.flowMessageId,flag:"0"})),"启用"===e&&N(e,z.flowEnable({flowMessageId:A.flowMessageId,flag:"1"})),"编辑"===e&&(A.MessageBox.show=!0)})(h(A).MessageBox.type))},{default:v((()=>[Qa])),_:1}),y(i,{onClick:n[5]||(n[5]=e=>h(A).MessageBox.show=!1)},{default:v((()=>[Xa])),_:1})])),_:1},8,["modelValue","show"]),y(S,{modelValue:h(A).showToastDialog.show,"onUpdate:modelValue":n[7]||(n[7]=e=>h(A).showToastDialog.show=e),show:h(A).showToastDialog.show,defaultAttribute:{}},{header:v((()=>[f("div",Za,[f("img",{src:h(A).showToastDialog.header.icon,alt:""},null,8,el),f("span",null,V(h(A).showToastDialog.header.data),1)])])),content:v((()=>[f("div",al,V(h(A).showToastDialog.content.data),1),y(_,{class:"scrollbar","max-height":"200px"},{default:v((()=>[(c(!0),m(g,null,I(h(A).batchColumnData,(e=>(c(),m("div",{key:e,class:"scrollbar-demo-item"},V(e),1)))),128))])),_:1})])),footer:v((()=>[(c(!0),m(g,null,I(h(A).componentsBatch.butDatas,(e=>(c(),b(i,{key:e.name,type:e.type,onClick:e.clickName},{default:v((()=>[T(V(e.name),1)])),_:2},1032,["type","onClick"])))),128))])),_:1},8,["modelValue","show"])])}}},[["__scopeId","data-v-38977b56"]]);export{ll as default};
